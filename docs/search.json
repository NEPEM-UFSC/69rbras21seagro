[
  {
    "objectID": "09_vcomp.html#modelo",
    "href": "09_vcomp.html#modelo",
    "title": "09: Dissimilaridade genética e componentes de variância em genótipos de linho dourado e marrom",
    "section": "\n4.1 Modelo",
    "text": "4.1 Modelo\n\n\nvcomp &lt;- function(data, traits, gen_col = \"GEN\",\n                  plant_col = \"PLANTA\",\n                  block_col = \"BLOCK\", check_col = \"CHECKS\") {\n  \n  data$GEN_PLANTA &lt;- interaction(data[[gen_col]], data[[plant_col]], drop = TRUE)\n  resultados &lt;- lapply(traits, function(trait) {\n    dados_filtrados &lt;- data[!is.na(data[[trait]]), ]\n    \n    formula_completa &lt;- as.formula(paste(trait, \"~ factor(\", block_col, \") + (1|\", gen_col, \") + (1|GEN_PLANTA)\"))\n    modelo &lt;- lmer(formula_completa, data = dados_filtrados, REML = TRUE)\n    vc &lt;- as.data.frame(VarCorr(modelo))\n    var_gen &lt;- vc[vc$grp == gen_col, \"vcov\"]\n    var_res &lt;- vc[vc$grp == \"Residual\", \"vcov\"]\n    var_planta &lt;- vc[vc$grp == \"GEN_PLANTA\", \"vcov\"]\n    \n    n &lt;- 4\n    print(n)\n    H2 &lt;- var_gen / (var_gen + (var_planta + var_res) / n)\n    \n    ran &lt;- tryCatch({\n      ranova(modelo) |&gt; as.data.frame() |&gt; dplyr::select(Chisq = 4, p = 6) |&gt; drop_na()\n    }, error = function(e) data.frame(Chisq = NA, p = NA))\n    \n    resultado &lt;- data.frame(\n      parametro = c(\"var_gen\", \"var_planta\", \"var_res\", \"n_media\", \"H2\", \"LRT\", \"p_genotipo\"),\n      valor = c(var_gen, var_planta, var_res, n, H2, ran$Chisq[1], ran$p[1])\n    )\n    names(resultado)[2] &lt;- trait\n    return(resultado)\n  })\n  \n  # Juntar os resultados por parâmetro\n  df_final &lt;- \n    resultados %&gt;%\n    reduce(full_join, by = \"parametro\")\n  return(df_final)\n}\n\nvariaveis &lt;- c(\"AP\", \"AC\", \"CP\", \"MC\", \"MG\", \"MMG\", \"ICC\", \"NR\", \"NC\", \"NG\")\nvals &lt;- vcomp(df, variaveis)\n## [1] 4\n## [1] 4\n## [1] 4\n## [1] 4\n## [1] 4\n## [1] 4\n## [1] 4\n## [1] 4\n## [1] 4\n## [1] 4\nexport(vals, \"data/vcomp.xlsx\")",
    "crumbs": [
      "About",
      "09: Dissimilaridade genética e componentes de variância em genótipos de linho dourado e marrom"
    ]
  },
  {
    "objectID": "09_vcomp.html#gráficos",
    "href": "09_vcomp.html#gráficos",
    "title": "09: Dissimilaridade genética e componentes de variância em genótipos de linho dourado e marrom",
    "section": "\n4.2 Gráficos",
    "text": "4.2 Gráficos\n\ndf_vcomp &lt;- \n  vals |&gt; \n  slice(1:3) |&gt;\n  pivot_longer(-parametro) |&gt; \n  mutate(\n    value = case_when(\n      parametro == \"var_planta\" ~ value  / 5,\n      parametro == \"var_res\" ~ value  / 5,\n      TRUE ~value\n    )\n  )\n\nvcmp &lt;- \nggplot(df_vcomp, aes(name, value))+\n  geom_col(aes(fill = parametro), position = \"fill\",\n           color = \"black\") +\n  theme_stata(base_size = 14) +\n  scale_y_continuous(expand = expansion(0)) +\n  scale_x_discrete(expand = expansion(0)) +\n  theme(axis.text.y = element_text(angle = 0)) +\n  scale_fill_manual(\n    values = c(\"var_gen\" = \"#F8766D\", \"var_planta\" = \"#00BA38\", \"var_res\" = \"#619CFF\"),\n    labels = c(\n      \"var_gen\" = expression(sigma[g]^2),\n      \"var_planta\" = expression(sigma[g(p)]^2),\n      \"var_res\" = expression(sigma[e]^2)\n    )\n  ) +\n  labs(x = \"Caracteres\",\n       y = \"Proporção da variância fenotípica\",\n       fill = \"\")\n\nbox + vcmp +\n    plot_layout(widths = c(0.6, 0.4)) +\n  plot_annotation(tag_levels = \"a\", \n                  tag_suffix = \")\")\n\n\n\n\n\n\n\n# ggsave(\"figs/boxplot_vcomp.jpg\",\n#        width = 15,\n#        height = 6)\n\n\nlibrary(lme4)",
    "crumbs": [
      "About",
      "09: Dissimilaridade genética e componentes de variância em genótipos de linho dourado e marrom"
    ]
  },
  {
    "objectID": "09_vcomp.html#distancia-e-agrupamento",
    "href": "09_vcomp.html#distancia-e-agrupamento",
    "title": "09: Dissimilaridade genética e componentes de variância em genótipos de linho dourado e marrom",
    "section": "\n4.3 Distancia e Agrupamento",
    "text": "4.3 Distancia e Agrupamento\n\n\ndfmedias &lt;- \n  df |&gt; \n  group_by(TIPO, GEN) |&gt; \n  summarise(across(AP:ICC, \\(x){mean(x, na.rm = TRUE)}),\n            .groups = \"drop\")\n\ndfdist &lt;- \n  dfmedias |&gt; \n  slice(1:2) |&gt; \n  select(GEN, AP:ICC)\n\nggplot(dfdist, aes(AP, AC)) +\n  geom_point() +\n  geom_hline(yintercept = 26.25) +\n  geom_vline(xintercept = 67.25)\n\n\n\n\n\n\n\n# a2 = b2 + c2\n# a^2 = 100\n# a = raiz(100)\n\nmat &lt;- dfdist |&gt; column_to_rownames(\"GEN\") |&gt; as.matrix()\nmat[1, 1] &lt;- 107\n# DISTANCIA DO G1 PARA G104 considerando AP e AC\nsqrt(sum((mat[1, ] - mat[2, ])^2))\n## [1] 136.4336",
    "crumbs": [
      "About",
      "09: Dissimilaridade genética e componentes de variância em genótipos de linho dourado e marrom"
    ]
  },
  {
    "objectID": "09_vcomp.html#dourada",
    "href": "09_vcomp.html#dourada",
    "title": "09: Dissimilaridade genética e componentes de variância em genótipos de linho dourado e marrom",
    "section": "\n5.1 Dourada",
    "text": "5.1 Dourada\n\nmat &lt;- \n  dfmedias |&gt; \n  group_by(TIPO) |&gt; \n  nest()\n\nmatd &lt;- mat$data[[1]] |&gt; column_to_rownames(\"GEN\")\nddourada &lt;- clustering(matd)\n\ndend_dourada &lt;- \n  fviz_dend(ddourada$hc,\n            main = \"\",\n            type = \"phylogenic\",\n            k = 3)   +\n  ylim(-20, 600)",
    "crumbs": [
      "About",
      "09: Dissimilaridade genética e componentes de variância em genótipos de linho dourado e marrom"
    ]
  },
  {
    "objectID": "09_vcomp.html#marrom",
    "href": "09_vcomp.html#marrom",
    "title": "09: Dissimilaridade genética e componentes de variância em genótipos de linho dourado e marrom",
    "section": "\n5.2 Marrom",
    "text": "5.2 Marrom\n\nmatm &lt;- mat$data[[2]] |&gt; column_to_rownames(\"GEN\")\nmarrom &lt;- clustering(matm)\n\ndend_marrom &lt;- \n  fviz_dend(marrom$hc,\n            main = \"\",\n            k = 3)  +\n  ylim(-20, 600)\n\ndend_dourada + dend_marrom +\n  plot_layout(widths = c(0.3, 0.7)) +\n  plot_annotation(tag_levels = \"a\", \n                  tag_suffix = \")\")\n\n\n\n\n\n\n# ggsave(\n#   \"figs/dendrograma.jpg\",\n#   width = 10,\n#   height = 5\n# )",
    "crumbs": [
      "About",
      "09: Dissimilaridade genética e componentes de variância em genótipos de linho dourado e marrom"
    ]
  },
  {
    "objectID": "02_progresso.html",
    "href": "02_progresso.html",
    "title": "02: Avanços no melhoramento do linho no Sul do Brasil: Resultados do Programa de Melhoramento NEPEM/UFSC",
    "section": "",
    "text": "1 Pacotes\n\nlibrary(rio)\nlibrary(tidyverse)\nlibrary(ggpubr)\nlibrary(ggridges)\n\n\n2 Dados\n\ndf &lt;- import_list(\"data/progresso.xlsx\")\ndf$`2024` &lt;- \n  df$`2024` |&gt; \n  filter(RGPLA &gt; 1.5)\n\njunto &lt;- \n  bind_rows(df) |&gt; \n  mutate(ANO = as.factor(ANO))\n\ndfmean &lt;-\n  junto |&gt;\n  group_by(ANO) |&gt;\n  summarise(across(AP:RGPLA, \\(x){mean(x, na.rm = TRUE)})) |&gt; \n  mutate(ANO = as.factor(ANO))\n\n\n3 Estatística descritiva\n\njunto  |&gt; \n  group_by(ANO) |&gt; \n  summarise(\n    n = n(),\n    min = min(RGPLA, na.rm = TRUE),\n    max = max(RGPLA, na.rm = TRUE),\n    media = mean(RGPLA, na.rm = TRUE),\n    dp = sd(RGPLA, na.rm = TRUE),\n    cv = dp / media * 100\n  )\n## # A tibble: 3 × 7\n##   ANO       n   min   max media    dp    cv\n##   &lt;fct&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n## 1 2022    229 0.01   5.44 0.698 0.738 106. \n## 2 2023    101 0.239  7.47 2.49  1.48   59.5\n## 3 2024     32 1.51   5.70 3.28  1.07   32.5\n\n\n4 Teste t\n\n# Calculate n per group\ndf_n &lt;- \n  junto  |&gt; \n  group_by(ANO) |&gt; \n  summarise(n = n(), .groups = 'drop')\n\nbox &lt;-\n  ggplot(junto, aes(x = ANO, y = RGPLA))+\n  geom_boxplot(aes(fill = ANO),\n               outliers = FALSE) +\n  geom_jitter(width = 0.2, alpha = 0.15) +\n  stat_summary(fun = mean,\n               geom = \"point\",\n               shape = 5,\n               fill = \"red\",\n               size = 2,\n               stroke = 1) +\n  stat_compare_means(method = \"t.test\",\n                     method.args = list(var.equal = TRUE),\n                     comparisons = list(c(\"2022\", \"2023\"),\n                                        c(\"2022\", \"2024\"),\n                                        c(\"2023\", \"2024\"))) +\n  geom_text(data = df_n,\n            aes(x = ANO, y = 0, label = paste0(\"n = \", n)),\n            color = \"gray50\",\n            nudge_y = -1,\n            inherit.aes = FALSE) +\n  ggthemes::theme_stata(base_size = 14) +\n  theme(axis.text.y  = element_text(angle = 0),\n        axis.text.x = element_blank(),\n        axis.title.x = element_blank()) +\n  ylim(c(0, 10)) +\n  coord_flip() +\n  labs(x = \"Ano de cultivo\",\n       y = \"Rendimento de grãos por planta (g)\",\n       fill = \"\")\n\n\n5 Densidade\n\ndfmean &lt;-\n  junto |&gt;\n  group_by(ANO) |&gt;\n  summarise(media = mean(RGPLA, na.rm = TRUE))\n\ndfmean\n## # A tibble: 3 × 2\n##   ANO   media\n##   &lt;fct&gt; &lt;dbl&gt;\n## 1 2022  0.698\n## 2 2023  2.49 \n## 3 2024  3.28\ndens &lt;-\n  ggplot(junto, aes(x = RGPLA, y = ANO, group = ANO, fill = ANO)) +\n  geom_density_ridges(alpha = 0.7) +\n  xlim(c(0, 10)) +\n  geom_vline(data = dfmean,\n             aes(xintercept = media,\n                 color = ANO),\n             show.legend = FALSE) +\n  ggthemes::theme_stata(base_size = 14) +\n  theme(axis.text.y  = element_text(angle = 0)) +\n  labs(x = \"Rendimento de grãos por planta (g)\",\n       y = \"Ano de cultivo\",\n       fill = \"\") \n\n\nlibrary(patchwork)\nbox /dens +\n  plot_annotation(tag_levels = \"a\") + \n  plot_layout(guides = \"collect\",\n              heights = c(0.3, 0.7)) & \n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n# ggsave(\"figs/ganho.jpg\",\n#        width = 10, \n#        height = 6)\n\n\n6 Rendimento de Grãos\n\ndf2024 &lt;- \n  df$`2024` |&gt; \n  mutate(check = ifelse(GEN == \"ST_PIONEIRA\", \"Check\", \"Genótipos NEPEM\"))\n\n\ndf2024 |&gt; \n  group_by(check) |&gt; \n  summarise(mean(RGPLA))\n## # A tibble: 2 × 2\n##   check           `mean(RGPLA)`\n##   &lt;chr&gt;                   &lt;dbl&gt;\n## 1 Check                    4.17\n## 2 Genótipos NEPEM          3.22\n\nggplot(df2024, aes(x = reorder(GEN, -RGPLA), y = RGPLA, fill = check)) +\n  geom_col(color = \"black\") +\n  facet_wrap(~TIPO, \n             scales = \"free_x\") +\n  geom_hline(yintercept = 4.17,\n             linetype = 2,\n             color = \"red\") +\n  scale_fill_manual(values = c(\"salmon\", \"#1AB281\")) +\n  coord_radial(start = -0.5 * pi, end = 0.5 * pi, inner.radius = 0.3) +\n  scale_y_continuous(breaks = 0:6) +\n  ggthemes::theme_stata(base_size = 14) +\n  theme(panel.grid.major.x = element_line(),\n        plot.caption = element_text(hjust = 1, size = 12, face = \"italic\"),\n        plot.title = element_text(hjust = 0),\n        plot.subtitle = element_text(hjust = 0, size = 12, face = \"italic\")) +\n  labs(x = \"\",\n       y = \"\",\n       fill = \"\",\n       title = \"Rendimento de grãos por planta (g) em genótipos de linhaça Marrom e Dourada\",\n       subtitle = \"Safra 2024\",\n       caption = \"Programa de Melhoramento NEPEM/UFSC\")\n\n\n\n\n\n\n\n\n7 Section info\n\nsessionInfo()\n## R version 4.4.2 (2024-10-31 ucrt)\n## Platform: x86_64-w64-mingw32/x64\n## Running under: Windows 11 x64 (build 26100)\n## \n## Matrix products: default\n## \n## \n## locale:\n## [1] LC_COLLATE=Portuguese_Brazil.utf8  LC_CTYPE=Portuguese_Brazil.utf8   \n## [3] LC_MONETARY=Portuguese_Brazil.utf8 LC_NUMERIC=C                      \n## [5] LC_TIME=Portuguese_Brazil.utf8    \n## \n## time zone: America/Sao_Paulo\n## tzcode source: internal\n## \n## attached base packages:\n## [1] stats     graphics  grDevices utils     datasets  methods   base     \n## \n## other attached packages:\n##  [1] patchwork_1.3.0 ggridges_0.5.6  ggpubr_0.6.0    lubridate_1.9.4\n##  [5] forcats_1.0.0   stringr_1.5.1   dplyr_1.1.4     purrr_1.0.2    \n##  [9] readr_2.1.5     tidyr_1.3.1     tibble_3.2.1    ggplot2_3.5.1  \n## [13] tidyverse_2.0.0 rio_1.2.3      \n## \n## loaded via a namespace (and not attached):\n##  [1] utf8_1.2.4        generics_0.1.3    rstatix_0.7.2     stringi_1.8.4    \n##  [5] hms_1.1.3         digest_0.6.37     magrittr_2.0.3    evaluate_1.0.3   \n##  [9] grid_4.4.2        timechange_0.3.0  fastmap_1.2.0     cellranger_1.1.0 \n## [13] R.oo_1.27.0       jsonlite_1.9.1    R.utils_2.12.3    ggthemes_5.1.0   \n## [17] backports_1.5.0   Formula_1.2-5     scales_1.3.0      abind_1.4-8      \n## [21] cli_3.6.4         rlang_1.1.5       R.methodsS3_1.8.2 munsell_0.5.1    \n## [25] withr_3.0.2       yaml_2.3.10       tools_4.4.2       tzdb_0.5.0       \n## [29] ggsignif_0.6.4    colorspace_2.1-1  broom_1.0.7       vctrs_0.6.5      \n## [33] R6_2.6.1          lifecycle_1.0.4   car_3.1-3         htmlwidgets_1.6.4\n## [37] pkgconfig_2.0.3   pillar_1.10.1     gtable_0.3.6      glue_1.8.0       \n## [41] xfun_0.50         tidyselect_1.2.1  rstudioapi_0.17.1 knitr_1.49       \n## [45] farver_2.1.2      htmltools_0.5.8.1 labeling_0.4.3    rmarkdown_2.29   \n## [49] carData_3.0-5     compiler_4.4.2    readxl_1.4.3",
    "crumbs": [
      "About",
      "02: Avanços no melhoramento do linho no Sul do Brasil: Resultados do Programa de Melhoramento NEPEM/UFSC"
    ]
  },
  {
    "objectID": "06_trilha.html",
    "href": "06_trilha.html",
    "title": "06: Análise de trilha em linhaça",
    "section": "",
    "text": "library(rio)\nlibrary(tidyverse)\nlibrary(metan)\n\nplanta &lt;- \n  import(\"data/dados_labfoto.xlsx\") |&gt; \n  select(UNIQUE_ID, GEN, PLANTA:NG, -NPT) |&gt; \n  remove_rows_na() |&gt; \n  mutate(MMG = MG / NG * 1000,\n         ICC = MG / MC)\n\n\nggplot(planta, aes(NG, MG)) +\n  geom_point()\n\n\n\n\n\n\n# bindar as informações dos grãos\n\ngraos &lt;- \n  import(\"data/graos_raw.csv\") |&gt; \n  group_by(img) |&gt; \n  summarise(\n    ELGRA = mean(elongation)\n  ) |&gt; \n  rename(UNIQUE_ID = img)\n\ncapsulas &lt;- \n  import(\"data/capsulas_raw.csv\") |&gt; \n  group_by(img) |&gt; \n  summarise(\n    ELCAP = mean(elongation)\n  ) |&gt; \n  rename(UNIQUE_ID = img)\n\ndfplantas &lt;- reduce(list(planta, graos, capsulas), left_join)\n\ndfmedias &lt;- \n  dfplantas |&gt; \n  group_by(GEN) |&gt; \n  summarise(across(where(is.numeric), \\(x){mean(x, na.rm = TRUE)})) |&gt; \n  remove_rows_na()",
    "crumbs": [
      "About",
      "06: Análise de trilha em linhaça"
    ]
  },
  {
    "objectID": "06_trilha.html#vifs",
    "href": "06_trilha.html#vifs",
    "title": "06: Análise de trilha em linhaça",
    "section": "\n2.1 VIFS",
    "text": "2.1 VIFS\n\ncolin_plantas &lt;- colindiag(dfplantas, -MG)\ncolin_medias &lt;- colindiag(dfmedias, - MG)\n\ncoldiag &lt;- \n  colin_plantas$VIF |&gt; rename(VIF_PLANTA = VIF) |&gt; \n  left_join(\n    colin_medias$VIF |&gt; rename(VIF_MEDIA = VIF)\n  )\n\ncoldiag\n##      var VIF_PLANTA VIF_MEDIA\n## 1     AP   1.800735  2.947845\n## 2     AC   1.800969  3.010562\n## 3     MC  61.029114 81.109328\n## 4     NR   1.210052  1.371786\n## 5     NC  12.432882 18.625749\n## 6     NG  49.730697 63.534923\n## 7    MMG   2.136226  3.710346\n## 8    ICC   3.056974  5.771233\n## 9  ELGRA   1.388911  1.562721\n## 10 ELCAP   1.070049  1.289736\n\n\ndet(as.matrix(colin_medias$cormat))\n## [1] 7.313194e-05",
    "crumbs": [
      "About",
      "06: Análise de trilha em linhaça"
    ]
  },
  {
    "objectID": "06_trilha.html#autovalores-autovetores",
    "href": "06_trilha.html#autovalores-autovetores",
    "title": "06: Análise de trilha em linhaça",
    "section": "\n2.2 Autovalores-autovetores",
    "text": "2.2 Autovalores-autovetores\n\nevmed &lt;- colin_medias$evalevet |&gt; mutate(cenario = \"medias\", .before = 1)\nevplanta &lt;- colin_plantas$evalevet |&gt; mutate(cenario = \"plantas\", .before = 1)\nevalevet &lt;- bind_rows(evmed, evplanta) |&gt; round_cols(digits = 3)\nexport(evalevet, \"data/evalevet.xlsx\")",
    "crumbs": [
      "About",
      "06: Análise de trilha em linhaça"
    ]
  },
  {
    "objectID": "06_trilha.html#sem-nenhuma-correção",
    "href": "06_trilha.html#sem-nenhuma-correção",
    "title": "06: Análise de trilha em linhaça",
    "section": "\n3.1 Sem nenhuma correção",
    "text": "3.1 Sem nenhuma correção\n#Regressão em crista #Diagonal Direto, linha indireto #DIreto -&gt; efeito puro da variável, soma da linha -&gt; pearson. #VIF, menor que 10 #Condição(Razão maior e menor abaixo de 100, ) #Determinante quanto menor, mais problemático",
    "crumbs": [
      "About",
      "06: Análise de trilha em linhaça"
    ]
  },
  {
    "objectID": "06_trilha.html#estimando-os-coeficientes",
    "href": "06_trilha.html#estimando-os-coeficientes",
    "title": "06: Análise de trilha em linhaça",
    "section": "\n3.2 Estimando os coeficientes",
    "text": "3.2 Estimando os coeficientes\n\nlibrary(metan)\ncor.x &lt;- as.matrix(colin_medias$cormat)\ncorrel &lt;- corr_coef(dfmedias)\ncor.y &lt;- as.vector(corr_focus(correl, MG)$MG)\n\ndireto &lt;- solve(cor.x %*% t(cor.x)) %*% cor.x %*% cor.y\nn &lt;- ncol(cor.x)\nCoeff &lt;- data.frame(cor.x)\nfor (i in 1:n) {\n  for (j in 1:n) {\n    Coeff[i, j] &lt;- direto[j] * cor.x[i, j]\n  }\n}\nCoeff\n##                  AP            AC          MC            NR          NC\n## AP    -7.296934e-03  0.0144750730  0.16448933  2.484704e-04 -0.04503164\n## AC    -5.400406e-03  0.0195584661  0.08256195  3.939671e-05 -0.01918930\n## MC    -2.197001e-03  0.0029557440  0.54632102  3.828740e-04 -0.12219303\n## NR    -1.599879e-03  0.0006799343  0.18457631  1.133255e-03 -0.04066180\n## NC    -2.566313e-03  0.0029312002  0.52136974  3.598868e-04 -0.12804084\n## NG    -2.398683e-03  0.0045072894  0.52735473  3.055002e-04 -0.11601567\n## MMG   -5.778469e-04  0.0001634311  0.24437080  1.317597e-04 -0.04530529\n## ICC   -1.909959e-03  0.0080600811  0.26378785  5.229241e-05 -0.04409625\n## ELGRA  2.029804e-03 -0.0031475074 -0.28873898 -5.641310e-05  0.06824930\n## ELCAP  8.019718e-05 -0.0024087218  0.05356116 -7.346018e-05 -0.02073880\n##                NG           MMG          ICC        ELGRA         ELCAP\n## AP     0.17769905  0.0037518055  0.011702816 -0.005875656 -0.0002370126\n## AC     0.12457567  0.0003958839  0.018425164 -0.003399183 -0.0026558568\n## MC     0.52180413  0.0211918739  0.021588060 -0.011163494  0.0021142429\n## NR     0.14572573  0.0055083656  0.002063087 -0.001051465 -0.0013979029\n## NC     0.48980216  0.0167636428  0.015397843 -0.011258806  0.0034929135\n## NG     0.54057080  0.0161608207  0.027178292 -0.011626997  0.0013092050\n## MMG    0.18439453  0.0473770436  0.019666242 -0.003501026  0.0060901856\n## ICC    0.32860033  0.0208392753  0.044710213 -0.005307708  0.0014528852\n## ELGRA -0.29756203 -0.0078527305 -0.011234950  0.021122369 -0.0023103776\n## ELCAP  0.03281765  0.0133796788  0.003012210 -0.002262939  0.0215651656",
    "crumbs": [
      "About",
      "06: Análise de trilha em linhaça"
    ]
  },
  {
    "objectID": "06_trilha.html#seleção-de-variáveis",
    "href": "06_trilha.html#seleção-de-variáveis",
    "title": "06: Análise de trilha em linhaça",
    "section": "\n3.3 Seleção de variáveis",
    "text": "3.3 Seleção de variáveis\n\ntrilha2_planta &lt;- \n  path_coeff(dfplantas, \n             resp = MG,\n             pred = everything(),\n             brutstep = TRUE)\n## --------------------------------------------------------------------------\n## The algorithm has selected a set of 8 predictors with largest VIF = 1.787. \n## Selected predictors: ELCAP MMG NR ICC ELGRA NC AC AP \n## A forward stepwise-based selection procedure will fit 6 models.\n## --------------------------------------------------------------------------\n## Adjusting the model 1 with 7 predictors (16.67% concluded)\n## Adjusting the model 2 with 6 predictors (33.33% concluded)\n## Adjusting the model 3 with 5 predictors (50% concluded)\n## Adjusting the model 4 with 4 predictors (66.67% concluded)\n## Adjusting the model 5 with 3 predictors (83.33% concluded)\n## Adjusting the model 6 with 2 predictors (100% concluded)\n## Done!\n## --------------------------------------------------------------------------\n## Summary of the adjusted models \n## --------------------------------------------------------------------------\n##    Model AIC Numpred   CN Determinant    R2 Residual maxVIF\n##  MODEL_1 410       7 6.63       0.323 0.891    0.331   1.76\n##  MODEL_2 408       6 6.56       0.337 0.891    0.331   1.76\n##  MODEL_3 407       5 3.77       0.593 0.890    0.332   1.36\n##  MODEL_4 407       4 3.14       0.685 0.889    0.333   1.30\n##  MODEL_5 407       3 1.99       0.886 0.888    0.335   1.12\n##  MODEL_6 409       2 1.47       0.964 0.884    0.340   1.04\n## --------------------------------------------------------------------------\n\nplot(trilha2_planta$Models$Model_1)\n\n\n\n\n\n\n\nexport(trilha2_planta$Summary, \"data/brutestep.xlsx\")\n\n# ggsave(\"figs/trilha2_planta.jpg\",\n#        width = 6, height = 6)",
    "crumbs": [
      "About",
      "06: Análise de trilha em linhaça"
    ]
  },
  {
    "objectID": "07_envirotyping.html",
    "href": "07_envirotyping.html",
    "title": "07: Caracterização climática em ambientes contrastantes de cultivo de linhaça em Santa Catarina",
    "section": "",
    "text": "1 Pacotes\n\n2 caracterização ambiental\nhttps://academic.oup.com/g3journal/article/11/4/jkab040/6129777\n\nlibrary(envirotypeR)\nlibrary(tidyverse)\nlibrary(ggridges)\nlibrary(rio)\nlibrary(ggthemes)\nlibrary(patchwork)\nlibrary(pliman)\nenv &lt;- c(\"FLO2022\", \"FLO2023\", \"CN2024\")\nlat &lt;- c(-27.681, -27.681, -27.370)\nlon &lt;- c(-48.541, -48.541, -51.204)\nstart.day &lt;- c(\"15/04/2022\", \"15/04/2023\", \"20/05/2024\")\nend.day &lt;-   c(\"30/09/2022\", \"30/09/2023\", \"15/11/2024\")\n\nas.Date(\"15/04/2022\", format = \"%d/%m/%Y\") + 150\n## [1] \"2022-09-12\"\n# climate &lt;- \n#   envirotypeR::get_weather(\n#     env.id = env,\n#     lat = lat,\n#     lon = lon,\n#     start.day = start.day,\n#     end.day = end.day\n#   )\n# \n# export(climate, \"data/climate.xlsx\")\nclimate &lt;- \n  import(\"data/climate.xlsx\") |&gt; \n  mutate(env = factor(env, c(\"FLO2022\", \"FLO2023\", \"CN2024\")))\n\n\n3 Comparação dos dados da estação com NASAPOWER\n\ntemps_2022 &lt;- \n  import(\"data/temps_2022.csv\") |&gt; \n  separate_wider_delim(Horário, \n                       names = c(\"dia\", \"hora\"), \n                       delim = \" \",\n                       too_few = \"align_start\") |&gt; \n  mutate(YYYYMMDD = lubridate::dmy(dia),\n         env = \"FLO2022\") |&gt; \n  separate_wider_delim(dia, \n                       names = c(\"dia\", \"mes\", \"ano\"), \n                       delim = \"-\") |&gt; \n  group_by(dia, mes, env) |&gt; \n  summarise(T2M_MAX_EST = max(`Temperatura do Ar Mínima`, na.rm = TRUE),\n            T2M_MIN_EST = min(`Temperatura do Ar Mínima`, na.rm = TRUE),\n            UR = mean(`Umidade do Ar Média`, na.rm = TRUE))\n\ntemps_2023 &lt;- \n  import(\"data/temps_2023.csv\") |&gt; \n  separate_wider_delim(Horário, \n                       names = c(\"dia\", \"hora\"), \n                       delim = \" \",\n                       too_few = \"align_start\") |&gt; \n  mutate(YYYYMMDD = lubridate::dmy(dia),\n         env = \"FLO2023\") |&gt; \n  separate_wider_delim(dia, \n                       names = c(\"dia\", \"mes\", \"ano\"), \n                       delim = \"-\") |&gt; \n  group_by(dia, mes, env) |&gt; \n  summarise(T2M_MAX_EST = max(`Temperatura do Ar Mínima`, na.rm = TRUE),\n            T2M_MIN_EST = min(`Temperatura do Ar Mínima`, na.rm = TRUE),\n            UR = mean(`Umidade do Ar Média`, na.rm = TRUE))\n\ndados_estacao &lt;- bind_rows(temps_2022, temps_2023)\n# juntar nasapower com estação\ndfnp &lt;- \n  climate |&gt; \n  separate_wider_delim(YYYYMMDD, \n                       names = c(\"ano\", \"mes\", \"dia\"), \n                       delim = \"-\") \n\ndfcomp &lt;- \n  left_join(dfnp, dados_estacao) |&gt; \n  filter(env %in% c(\"FLO2022\", \"FLO2023\")) |&gt; \n  dplyr::select(env, T2M_MAX, T2M_MAX_EST, T2M_MIN, T2M_MIN_EST, RH2M,  UR) |&gt; \n  filter(!is.infinite(T2M_MAX_EST), T2M_MIN_EST &gt; 0, UR &gt; 60)\n\n\nrelacao_tmax &lt;- \n  ggplot(dfcomp, aes(T2M_MAX, T2M_MAX_EST, fill = env)) +\n  geom_point(shape =21, size = 3) +\n  facet_wrap(~env, ncol = 1) +\n  xlim(10, 40) +\n  ylim(10, 40) +\n  coord_equal() +\n  theme_bw(base_size = 14) +\n  geom_abline(intercept = 0, slope = 1) +\n  labs(x = \"Temperatura máxima NASAPOWER (ºC)\",\n       y = \"Temperatura máxima estação (ºC)\",\n       fill = \"\") \n\nrelacao_tmin &lt;- \n  ggplot(dfcomp, aes(T2M_MIN, T2M_MIN_EST, fill = env)) +\n  geom_point(shape =21, size = 3) +\n  facet_wrap(~env, ncol = 1) +\n  xlim(0, 25) +\n  ylim(0, 25) +\n  coord_equal() +\n  theme_bw(base_size = 14) +\n  geom_abline(intercept = 0, slope = 1) +\n  labs(x = \"Temperatura mínima NASAPOWER (ºC)\",\n       y = \"Temperatura mínima estação (ºC)\",\n       fill = \"\") \n\nrelacao_ur &lt;- \n  ggplot(dfcomp, aes(RH2M, UR, fill = env)) +\n  geom_point(shape =21, size = 3) +\n  facet_wrap(~env, ncol = 1) +\n  xlim(40, 100) +\n  ylim(40, 100) +\n  coord_equal() +\n  theme_bw(base_size = 14) +\n  geom_abline(intercept = 0, slope = 1) +\n  labs(x = \"Umidade relativa NASAPOWER (%)\",\n       y = \"Umidade relativa estação (%)\",\n       fill = \"\") \n\nrelacao_tmax + relacao_tmin + relacao_ur +\n  plot_annotation(tag_levels = \"a\", tag_suffix = \")\") +\n  plot_layout(guides = \"collect\") & \n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n# ggsave(\"figs/relacao_nasapower_estacao.jpg\", width = 12, height = 8)\n\n# checar a coincidencia\ncoef_tmax &lt;- \n  dfcomp |&gt; \n  group_by(env) |&gt; \n  ccc(T2M_MAX, T2M_MAX_EST) |&gt; \n  mutate(var = \"T2M_MAX\")\n\n# checar a coincidencia\ncoef_tmin &lt;- \n  dfcomp |&gt; \n  group_by(env) |&gt; \n  ccc(T2M_MIN, T2M_MIN_EST) |&gt; \n  mutate(var = \"T2M_MIN\")\n\ncoef_ur &lt;-\n  dfcomp |&gt; \n  group_by(env) |&gt; \n  ccc(RH2M, UR) |&gt; \n  mutate(var = \"RH2M\")\nbind_rows(coef_tmax, coef_tmin, coef_ur)\n## # A tibble: 6 × 5\n##   env         r   ccc  rmse var    \n##   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  \n## 1 FLO2022 0.858 0.850  1.72 T2M_MAX\n## 2 FLO2023 0.893 0.870  1.90 T2M_MAX\n## 3 FLO2022 0.835 0.819  1.88 T2M_MIN\n## 4 FLO2023 0.789 0.786  1.92 T2M_MIN\n## 5 FLO2022 0.704 0.611  6.93 RH2M   \n## 6 FLO2023 0.678 0.420  8.87 RH2M\n\n\n4 Gráficos de distribuição\n\ndfplot &lt;- \n  climate |&gt; \n  separate_wider_delim(YYYYMMDD,\n                       names = c(\"ano\", \"mes\", \"dia\"),\n                       delim = \"-\")\n\n\nptmin &lt;- \n  ggplot(dfplot, aes(T2M_MIN, y = mes, fill = after_stat(x))) +\n  facet_wrap(~env, ncol = 1) +\n  geom_density_ridges_gradient() +\n  scale_fill_viridis_c() +\n  theme(axis.text.y = element_text(angle = 0)) +\n  labs(x = \"Temperatura mínima (ºC)\",\n       y = \"Mês do ano\",\n       fill = \"(ºC)\")\n\nptmax &lt;- \n  ggplot(dfplot, aes(T2M_MAX, y = mes, fill = after_stat(x))) +\n  facet_wrap(~env, ncol = 1) +\n  geom_density_ridges_gradient() +\n  scale_fill_viridis_c() +\n  theme(axis.text.y = element_text(angle = 0)) +\n  labs(x = \"Temperatura máxima (ºC)\",\n       y = \"Mês do ano\",\n       fill = \"(ºC)\")\n\npumre &lt;- \n  ggplot(dfplot, aes(RH2M, y = mes, fill = after_stat(x))) +\n  facet_wrap(~env, ncol = 1) +\n  geom_density_ridges_gradient() +\n  scale_fill_viridis_c() +\n  theme(axis.text.y = element_text(angle = 0)) +\n  labs(x = \"Umidade relativa do ar (%)\",\n       y = \"Mês do ano\",\n       fill = \"%\")\n\nptmin + ptmax + pumre +\n  plot_annotation(tag_levels = \"a\", tag_suffix = \")\")\n\n\n\n\n\n\n\n# ggsave(\"figs/densidades_temp.jpg\", width = 12, height = 8)\n\n\n5 Tipagem ambiental\n\nclimate &lt;- \n  import(\"data/climate.xlsx\") |&gt; \n  dplyr::select(env, T2M_MAX, T2M_MIN, RH2M, daysFromStart, DOY) |&gt; \n  mutate(estadio = case_when(\n    between(daysFromStart, 0, 35) ~ \"Estabelecimento\",\n    between(daysFromStart, 36, 60) ~ \"Vegetativo\",\n    between(daysFromStart, 61, 90) ~ \"Floração\",\n    daysFromStart &gt; 90 ~ \"Reprodutivo\",\n  )) |&gt; \n  group_by(env) |&gt; \n  nest()\n\n\ncreate_class &lt;- function(data,\n                         var,\n                         breaks = c(10, 15, 20, 25, 30),\n                         labels = c(\"10-15\", \"15-20\", \"20-25\", \"&gt; 25\")) {\n  var &lt;- rlang::enquo(var)\n  if (dplyr::is_grouped_df(data)) {\n    dplyr::group_modify(data, ~create_class(.x, !!var, breaks, labels))\n  } else {\n    x &lt;- dplyr::select(data, !!var) |&gt; dplyr::pull()\n    xcut &lt;- cut(x, breaks = breaks, labels = labels)\n    as.data.frame(table(xcut)) |&gt;\n      dplyr::mutate(fr = Freq / sum(Freq))\n  }\n}\n\n# ENVIROTYPE TMAX\ndfclasses &lt;- \n  climate |&gt; \n  mutate(classes = map(data, ~create_class(.x |&gt; group_by(estadio), T2M_MAX))) |&gt; \n  unnest(classes) |&gt; \n  mutate(estadio = factor(estadio, \n                          levels = c(\"Estabelecimento\", \"Vegetativo\", \"Floração\",\n                                     \"Reprodutivo\")),\n         env = factor(env, c(\"FLO2022\", \"FLO2023\", \"CN2024\")))\n\netmax &lt;- \n  ggplot(dfclasses) +\n  geom_bar(aes(x=Freq,  y = env, fill = xcut),\n           position = \"fill\",\n           stat = \"identity\",\n           width = 1,\n           color = \"white\",\n           size=.2)+\n  facet_wrap(~estadio, ncol = 1) +\n  theme(legend.position = \"bottom\") +\n    scale_x_continuous(expand = expansion(0)) +\n  scale_y_discrete(expand = expansion(0)) +\n  labs(x = \"Frequência relativa\",\n       y = \"Ambiente de cultivo\",\n       fill = \"Temp máxima (ºC)\")\n\n\n# ENVIROTYPE TMIN\ndfettmin &lt;- \n  climate |&gt; \n  mutate(classes = map(data, function(x){\n    x |&gt; \n      group_by(estadio) |&gt; \n      create_class(breaks = c(0, 10, 15, 20, 25),\n                   labels = c(\"0-10\", \"10-15\", \"15-20\", \"&gt; 20\"),\n                   T2M_MIN)\n  })) |&gt; \n  unnest(classes) |&gt; \n  mutate(estadio = factor(estadio, \n                          levels = c(\"Estabelecimento\", \"Vegetativo\", \"Floração\",\n                                     \"Reprodutivo\")),\n         env = factor(env, c(\"FLO2022\", \"FLO2023\", \"CN2024\")))\n\n\netmin &lt;- \n  ggplot(dfettmin) +\n  geom_bar(aes(x=Freq,  y = env, fill = xcut),\n           position = \"fill\",\n           stat = \"identity\",\n           width = 1,\n           color = \"white\",\n           size=.2)+\n  theme(legend.position = \"bottom\") +\n    scale_x_continuous(expand = expansion(0)) +\n  scale_y_discrete(expand = expansion(0)) +\n  facet_wrap(~estadio, ncol = 1) +\n  labs(x = \"Frequência relativa\",\n       y = \"Ambiente de cultivo\",\n       fill = \"Temp mínima (ºC)\")\n\n# ENVIROTYPE UR\ndfettur &lt;- \n  climate |&gt; \n  mutate(classes = map(data, function(x){\n    x |&gt; \n      group_by(estadio) |&gt; \n      create_class(breaks = c(50, 65, 80, 95, 100),\n                   labels = c(\"50-65\", \"65-80\", \"80-95\", \"&gt; 95\"),\n                   RH2M)\n  })) |&gt; \n  unnest(classes) |&gt; \n  mutate(estadio = factor(estadio, \n                          levels = c(\"Estabelecimento\", \"Vegetativo\", \"Floração\",\n                                     \"Reprodutivo\")),\n         env = factor(env, c(\"FLO2022\", \"FLO2023\", \"CN2024\")))\n\n\netur &lt;- \n  ggplot(dfettur) +\n  geom_bar(aes(x=Freq,  y = env, fill = xcut),\n           position = \"fill\",\n           stat = \"identity\",\n           width = 1,\n           color = \"white\",\n           size=.2)+\n  facet_wrap(~estadio, ncol = 1) +\n  scale_x_continuous(expand = expansion(0)) +\n  scale_y_discrete(expand = expansion(0)) +\n  theme(legend.position = \"bottom\") +\n  labs(x = \"Ambiente de cultivo\",\n       y = \"Estádio fenológico\",\n       fill = \"Umidade Relativa (%)\")\n\n# juntar os gráficos\netmax + etmin + etur +\n  plot_annotation(tag_levels = \"a\", tag_suffix = \")\")\n\n\n\n\n\n\n\n# ggsave(\"figs/envirotype.jpg\", width = 13, height = 5)\n\n# rbind dos dados\nbind_rows(dfettur, dfettmin, dfclasses) |&gt; \n  export(\"data/envirotype.xlsx\")\n\n\n6 Section info\n\nsessionInfo()\n## R version 4.4.2 (2024-10-31 ucrt)\n## Platform: x86_64-w64-mingw32/x64\n## Running under: Windows 11 x64 (build 26100)\n## \n## Matrix products: default\n## \n## \n## locale:\n## [1] LC_COLLATE=Portuguese_Brazil.utf8  LC_CTYPE=Portuguese_Brazil.utf8   \n## [3] LC_MONETARY=Portuguese_Brazil.utf8 LC_NUMERIC=C                      \n## [5] LC_TIME=Portuguese_Brazil.utf8    \n## \n## time zone: America/Sao_Paulo\n## tzcode source: internal\n## \n## attached base packages:\n## [1] stats     graphics  grDevices utils     datasets  methods   base     \n## \n## other attached packages:\n##  [1] pliman_3.0.0.9000 patchwork_1.3.0   ggthemes_5.1.0    rio_1.2.3        \n##  [5] ggridges_0.5.6    lubridate_1.9.4   forcats_1.0.0     stringr_1.5.1    \n##  [9] dplyr_1.1.4       purrr_1.0.2       readr_2.1.5       tidyr_1.3.1      \n## [13] tibble_3.2.1      ggplot2_3.5.1     tidyverse_2.0.0   envirotypeR_0.1.5\n## \n## loaded via a namespace (and not attached):\n##  [1] writexl_1.5.1        tidyselect_1.2.1     viridisLite_0.4.2   \n##  [4] EBImage_4.46.0       farver_2.1.2         R.utils_2.12.3      \n##  [7] bitops_1.0-9         fastmap_1.2.0        RCurl_1.98-1.16     \n## [10] leaflet_2.2.2        mapview_2.11.2       promises_1.3.2      \n## [13] digest_0.6.37        timechange_0.3.0     mime_0.13           \n## [16] lifecycle_1.0.4      sf_1.0-19            terra_1.8-29        \n## [19] magrittr_2.0.3       exactextractr_0.10.0 compiler_4.4.2      \n## [22] rlang_1.1.5          tools_4.4.2          utf8_1.2.4          \n## [25] yaml_2.3.10          data.table_1.16.2    knitr_1.49          \n## [28] labeling_0.4.3       htmlwidgets_1.6.4    sp_2.2-0            \n## [31] classInt_0.4-11      abind_1.4-8          KernSmooth_2.23-24  \n## [34] withr_3.0.2          R.oo_1.27.0          BiocGenerics_0.50.0 \n## [37] grid_4.4.2           stats4_4.4.2         mapedit_0.6.0       \n## [40] xtable_1.8-4         e1071_1.7-16         leafem_0.2.3        \n## [43] colorspace_2.1-1     scales_1.3.0         cli_3.6.4           \n## [46] rmarkdown_2.29       generics_0.1.3       rstudioapi_0.17.1   \n## [49] tzdb_0.5.0           readxl_1.4.3         DBI_1.2.3           \n## [52] proxy_0.4-27         cellranger_1.1.0     tiff_0.1-12         \n## [55] base64enc_0.1-3      vctrs_0.6.5          jsonlite_1.9.1      \n## [58] hms_1.1.3            fftwtools_0.9-11     jpeg_0.1-10         \n## [61] crosstalk_1.2.1      locfit_1.5-9.10      units_0.8-7         \n## [64] glue_1.8.0           codetools_0.2-20     stringi_1.8.4       \n## [67] gtable_0.3.6         later_1.3.2          raster_3.6-31       \n## [70] munsell_0.5.1        pillar_1.10.1        htmltools_0.5.8.1   \n## [73] satellite_1.0.5      R6_2.6.1             evaluate_1.0.3      \n## [76] shiny_1.10.0         lattice_0.22-6       R.methodsS3_1.8.2   \n## [79] png_0.1-8            httpuv_1.6.15        class_7.3-22        \n## [82] Rcpp_1.0.14          xfun_0.50            pkgconfig_2.0.3",
    "crumbs": [
      "About",
      "07: Caracterização climática em ambientes contrastantes de cultivo de linhaça em Santa Catarina"
    ]
  },
  {
    "objectID": "08_cor.html",
    "href": "08_cor.html",
    "title": "08: Cor",
    "section": "",
    "text": "1 Pacotes\n\nlibrary(rio)\nlibrary(tidyverse)\nlibrary(factoextra)\nlibrary(FactoMineR)\nlibrary(metan)\nlibrary(ggthemes)\nlibrary(patchwork)\n\n\nquali &lt;- import(\"data/qualidade.xlsx\")\ntipos &lt;- import(\"data/tipos.xlsx\")\ncolor &lt;- import(\"data/color_2023.xlsx\")\n\ncolor &lt;- \n  color |&gt; \n  mutate(GEN = str_remove(img, pattern = \"proc_\")) |&gt; \n  select(-c(h, s, b, img)) |&gt; \n  relocate(GEN, .before = 1)\n\ndfcolor &lt;- \n  reduce(list(color, quali, tipos), left_join) |&gt; \n  relocate(TIPO, .before = GEN)\n\n\ncordf &lt;- \n  dfcolor  |&gt; \n  mutate(\n    # BCC = B / (R + G + B),\n    # BGI = B / G,\n    # BI = sqrt((R^2 + G^2 + B^2) / 3),\n    # BI2 = sqrt((R^2 + G^2 + B^2) / 3),\n    # BRVI = (B - R) / (B + R),\n    # CI = (R - B) / R,\n    # CIVE = (0.811 * G) + (0.385 * B) + 18.78745,\n    # EGVI = 2 * G - R - B,\n    # ERVI = (1.4 * R) - G,\n    # GCC = G / (R + G + B),\n    # GLI = ((G - R) + (G - B)) / (G + R + G + B),\n    # GLAI = 25 * (G - R) / (G + R - B) + 1.25,\n    # GR = G / R,\n    # GRAY = 0.299 * R + 0.587 * G + 0.114 * B,\n    # GRAY2 = ((R^2.2 + (1.5 * G)^2.2 + (0.6 * B)^2.2) / (1 + 1.5^2.2 + 0.6^2.2))^(1 / 2.2),\n    # GRVI2 = (G - R) / (G + R),\n    # GB = G / B,\n    # HI = (2 * R - G - B) / (G - B),\n    HUE = atan(2 * (B - G - R) / (30.5 * (G - R))),\n    # HUE2 = atan(2 * (R - G - R) / (30.5 * (G - B))),  # Parece incorreto: R-G-R = R*(1 - 1) - G = -G?\n    # I = R + G + B,\n    IPCA = 0.994 * abs(R - B) + 0.961 * abs(G - B) + 0.914 * abs(G - R),\n    # L = (R + G + B) / 3,\n    # MGVRI = (G^2 - R^2) / (G^2 + R^2),\n    # MVARI = (G - B) / (G + R - B),\n    # NB = B / (R + G + B),\n    # NDI = 128 * ((G - R) / (G + R) + 1),\n    # NG = G / (R + G + B),\n    # NGBDI = (G - B) / (G + B),\n    # NGRDI = (G - R) / (G + R),\n    # NR = R / (R + G + B),\n    # PRI = R / G,\n    # RB = R / B,\n    # RCC = R / (R + G + B),\n    # RGBVI = (G^2 - (B * R)) / (G^2 + (B * R)),\n    # RI = (R^2) / (B * G^3),\n    SAT = (pmax(R, G, B) - pmin(R, G, B)) / pmax(R, G, B),\n    SAVI = (1 + 0.5) * (G - R) / (G + R + 0.5),\n    # SCI = (R - G) / (R + G),\n    # SHP = 2 * (R - G - B) / (G - B),\n    # SI = (R - B) / (R + B),\n    # S = ((R + G + B) - 3 * B) / (R + G + B),\n    # TGI = G - 0.39 * R - 0.61 * B,\n    VARI = (G - R) / (G + R - B),\n    # VEG = G / (R^0.667 * B^0.334),\n    # vNDVI = 0.5268 * (R - 0.1294 * G^0.3389 * B - 0.3118),\n    # WI = (G - B) / (R - G)\n  )\n\n\n2 PCA\n\ndfpca &lt;- \n  cordf |&gt; \n  group_by(TIPO) |&gt; \n  nest()\n\ncord &lt;- corr_coef(dfpca$data[[1]])\ncorm &lt;- corr_coef(dfpca$data[[2]])\na &lt;- plot(cord, reorder = FALSE)\nb &lt;- plot(corm, reorder = FALSE)\n\na + b +\n  plot_annotation(tag_levels = list(c(\"Dourada\", \"Marrom\")))\n\n\n\n\n\n\n\nggsave(\"figs/correlacao_cor.jpg\",\n       width = 12,\n       height = 6)\n\npcad &lt;- PCA(dfpca$data[[1]] |&gt; column_to_rownames(\"GEN\"), graph = FALSE)\npcam &lt;- PCA(dfpca$data[[2]] |&gt; column_to_rownames(\"GEN\"), graph = FALSE)\n\nbip_d &lt;- fviz_pca_biplot(pcad, repel = TRUE) + theme_stata()\nbip_m &lt;- fviz_pca_biplot(pcam, repel = TRUE) + theme_stata()\n\nbip_d + bip_m +\n  plot_annotation(tag_levels = list(c(\"Dourada\", \"Marrom\")))\n\n\n\n\n\n\n\nggsave(\"figs/biplot_pca_cor.jpg\",\n       width = 15,\n       height = 6)\n\n\n3 Section info\n\nsessionInfo()\n## R version 4.4.2 (2024-10-31 ucrt)\n## Platform: x86_64-w64-mingw32/x64\n## Running under: Windows 11 x64 (build 26100)\n## \n## Matrix products: default\n## \n## \n## locale:\n## [1] LC_COLLATE=Portuguese_Brazil.utf8  LC_CTYPE=Portuguese_Brazil.utf8   \n## [3] LC_MONETARY=Portuguese_Brazil.utf8 LC_NUMERIC=C                      \n## [5] LC_TIME=Portuguese_Brazil.utf8    \n## \n## time zone: America/Sao_Paulo\n## tzcode source: internal\n## \n## attached base packages:\n## [1] stats     graphics  grDevices utils     datasets  methods   base     \n## \n## other attached packages:\n##  [1] patchwork_1.3.0  ggthemes_5.1.0   metan_1.19.0     FactoMineR_2.11 \n##  [5] factoextra_1.0.7 lubridate_1.9.4  forcats_1.0.0    stringr_1.5.1   \n##  [9] dplyr_1.1.4      purrr_1.0.2      readr_2.1.5      tidyr_1.3.1     \n## [13] tibble_3.2.1     ggplot2_3.5.1    tidyverse_2.0.0  rio_1.2.3       \n## \n## loaded via a namespace (and not attached):\n##  [1] Rdpack_2.6.2         sandwich_3.1-1       readxl_1.4.3        \n##  [4] rlang_1.1.5          magrittr_2.0.3       multcomp_1.4-26     \n##  [7] compiler_4.4.2       systemfonts_1.2.1    vctrs_0.6.5         \n## [10] pkgconfig_2.0.3      fastmap_1.2.0        backports_1.5.0     \n## [13] labeling_0.4.3       rmarkdown_2.29       tzdb_0.5.0          \n## [16] nloptr_2.1.1         ragg_1.3.3           xfun_0.50           \n## [19] jsonlite_1.9.1       flashClust_1.01-2    tweenr_2.0.3        \n## [22] broom_1.0.7          cluster_2.1.6        R6_2.6.1            \n## [25] stringi_1.8.4        RColorBrewer_1.1-3   GGally_2.2.1        \n## [28] car_3.1-3            boot_1.3-31          cellranger_1.1.0    \n## [31] numDeriv_2016.8-1.1  estimability_1.5.1   Rcpp_1.0.14         \n## [34] knitr_1.49           zoo_1.8-12           R.utils_2.12.3      \n## [37] Matrix_1.7-1         splines_4.4.2        timechange_0.3.0    \n## [40] tidyselect_1.2.1     abind_1.4-8          rstudioapi_0.17.1   \n## [43] yaml_2.3.10          codetools_0.2-20     lattice_0.22-6      \n## [46] lmerTest_3.1-3       plyr_1.8.9           withr_3.0.2         \n## [49] coda_0.19-4.1        evaluate_1.0.3       survival_3.7-0      \n## [52] ggstats_0.8.0        polyclip_1.10-7      pillar_1.10.1       \n## [55] ggpubr_0.6.0         carData_3.0-5        DT_0.33             \n## [58] reformulas_0.4.0     generics_0.1.3       mathjaxr_1.6-0      \n## [61] hms_1.1.3            munsell_0.5.1        scales_1.3.0        \n## [64] minqa_1.2.8          xtable_1.8-4         leaps_3.2           \n## [67] glue_1.8.0           emmeans_1.10.6       scatterplot3d_0.3-44\n## [70] tools_4.4.2          lme4_1.1-36          ggsignif_0.6.4      \n## [73] mvtnorm_1.3-3        grid_4.4.2           rbibutils_2.3       \n## [76] colorspace_2.1-1     nlme_3.1-166         ggforce_0.4.2       \n## [79] Formula_1.2-5        cli_3.6.4            textshaping_1.0.0   \n## [82] gtable_0.3.6         R.methodsS3_1.8.2    rstatix_0.7.2       \n## [85] digest_0.6.37        ggrepel_0.9.6        TH.data_1.1-3       \n## [88] htmlwidgets_1.6.4    farver_2.1.2         htmltools_0.5.8.1   \n## [91] R.oo_1.27.0          lifecycle_1.0.4      multcompView_0.1-10 \n## [94] MASS_7.3-61",
    "crumbs": [
      "About",
      "08: Cor"
    ]
  },
  {
    "objectID": "00_about.html",
    "href": "00_about.html",
    "title": "",
    "section": "",
    "text": "Code\n\nSobre este material\nNeste website você pode encontrar os dados e scripts utilizados nas análises dos seguintes trabalhos apresentados na 69\\(^a\\) Reunião Anual da Região Brasileira da Sociedade Internacional de Biometria (RBras) e 21\\(^o\\) Simpósio de Estatística Aplicada à Experimentação Agronômica (SEAGRO), realizados na Universidade Federal do Espírito Santo (UFES), em Vitória, Espírito Santo, de 4 a 8 de agosto de 2025.\nPesquisadores\n\n\n\n\n\n\nComo reproduzir?\n\nFaça o Download dos dados do repositório github;\nDescompacte para uma pasta;\nAbra o projeto 68rbras.Rproj no RStudio;\nOpcionalmente, altere funções e argumentos;\nRe-knit o documento para ver os resultados.\nLicença\nEste conteúdo está licenciado com uma Licença Creative Commons - Atribuição-NãoComercial-CompartilhaIgual 4.0 Internacional. O resumo legível da licença afirma que você tem o direito de:\n\nCompartilhar — copie e redistribua o material em qualquer meio ou formato.\nAdaptar — remixar, transformar e construir sobre o material\nAtribuir — Você deve dar o crédito apropriado, fornecer um link para a licença e indicar se foram feitas alterações. Você deve fazê-lo sob quaisquer circunstâncias razoáveis, mas de forma alguma sugerindo que o licenciante endossa você ou seu uso.\n\nEsta licença e válida sob os seguintes termos:\n\n\nNão comercial (NC) — Você não pode usar o material para fins comerciais.\n\nShare Alike (SA) — Se você remixar, transformar ou desenvolver o material, deverá distribuir suas contribuições sob a mesma licença do original.\n\nSem restrições adicionais — Você não pode aplicar termos legais ou medidas tecnológicas que restrinjam legalmente outras pessoas de fazer qualquer coisa que a licença permita.\nSelo DC\n\nO selo selo Democratizando Conhecimento (DC) é uma ideia criada pelo Prof. Ben Dêivid. O selo é compatível com a licença Creative Commons CC BY NC SA 4.0 e é utilizado aqui para garantir que o acesso de todo esse material seja livre, gratuíto e de código aberto.\nVisite-nos!"
  },
  {
    "objectID": "05_correlacao_pca.html",
    "href": "05_correlacao_pca.html",
    "title": "05: Análise de Correlação e PCA em Genótipos de Linhaça (Linum usitatissimum L.) Dourada e Marrom",
    "section": "",
    "text": "1 Pacotes\n\nlibrary(rio)\nlibrary(tidyverse)\nlibrary(factoextra)\nlibrary(FactoMineR)\nlibrary(metan)\nlibrary(corrplot)\nlibrary(ggthemes)\nlibrary(patchwork)\n\ndfgens &lt;- \n  import(\"data/dados_plantas.xlsx\") |&gt; \n  mutate(CP = AP - AC) |&gt; \n  group_by(GEN) |&gt; \n  summarise(across(AP:ICC, \\(x){mean(x, na.rm = TRUE)})) |&gt; \n  select(-AC)\ntipos &lt;- import(\"data/tipos.xlsx\")\n\ndfggplot &lt;- \n  dfgens |&gt; \n  left_join(tipos) \n\n\n2 Correlação\n\ncorrs &lt;- \ndfggplot |&gt; \n  group_by(TIPO) |&gt; \n  nest() |&gt; \n  mutate(corr = map(data, function(x){\n    corr_coef(x)\n  })) \n\n# numero de genótipos em cada \nmap(corrs$data[1:2], function(x){\n    summarise(x, n())\n  })|&gt; \n  list_rbind() |&gt; \n  mutate(tipo = c(\"dourada\", \"Marrom\"))\n## # A tibble: 2 × 2\n##   `n()` tipo   \n##   &lt;int&gt; &lt;chr&gt;  \n## 1    16 dourada\n## 2    24 Marrom\n\n\nlibrary(corrplot)\nlower &lt;- make_lower_tri(corrs$corr[[1]]$cor)\nupper &lt;- make_upper_tri(corrs$corr[[2]]$cor)\nlower[is.na(lower)] &lt;- upper[is.na(lower)]\ndiag(lower) &lt;- 1\n\n# PVAL\nlowerpv &lt;- make_lower_tri(corrs$corr[[1]]$pval)\nupperpv &lt;- make_upper_tri(corrs$corr[[2]]$pval)\nlowerpv[is.na(lowerpv)] &lt;- upperpv[is.na(lowerpv)]\ndiag(lowerpv) &lt;- 1\n\n\n# jpeg(\"figs/correlacao.jpg\", width = 6, height = 6, units = \"in\", res = 600)\ncorrplot(lower,\n         method = \"number\",\n         p.mat = lowerpv,\n         order = \"hclust\",\n         insig = \"pch\",\n         pch.cex = 1,\n         pch.col = \"gray50\",\n         diag = FALSE)\n\n\n\n\n\n\n# dev.off()\n\n\ncor_d &lt;- tidy_sym(corrs$corr[[1]]$cor, keep_diag = FALSE)\ncor_m &lt;- tidy_sym(corrs$corr[[2]]$cor, keep_diag = FALSE) |&gt; rename(value_m = value)\n\ncombs &lt;- \n  left_join(cor_d, cor_m) |&gt; \n  mutate(diff = value_m - value) %&gt;% \n  arrange(desc(diff))\n\n\n3 Exploração\n\nggplot(dfggplot, aes(CP, NC)) +\n  geom_point(aes(color = TIPO)) +\n  geom_smooth(aes(color = TIPO), method = \"lm\",\n              se = FALSE)\n\n\n\n\n\n\n\ndfm &lt;-\n  dfggplot |&gt; \n  filter(TIPO ==\"MARROM\")\nggplot(dfm, aes(CP, NC)) +\n  geom_point(aes(color = TIPO)) +\n  geom_smooth(aes(color = TIPO), method = \"lm\",\n              se = FALSE)\n\n\n\n\n\n\n\n\n4 PCA\n\ndfpca &lt;- \n  dfggplot |&gt; \n  group_by(TIPO) |&gt; \n  nest()\npcad &lt;- PCA(dfpca$data[[1]] |&gt; column_to_rownames(\"GEN\"), graph = FALSE)\npcam &lt;- PCA(dfpca$data[[2]] |&gt; column_to_rownames(\"GEN\"), graph = FALSE)\n\nbip_d &lt;- fviz_pca_biplot(pcad, repel = TRUE) + theme_stata()\nbip_m &lt;- fviz_pca_biplot(pcam, repel = TRUE) + theme_stata()\nbip_d + bip_m +\n  plot_annotation(tag_levels = list(c(\"Dourada\", \"Marrom\")))\n\n\n\n\n\n\n\n# ggsave(\"figs/biplot_pca.jpg\",\n#        width = 15,\n#        height = 6)\n\n\n5 Section info\n\nsessionInfo()\n## R version 4.4.2 (2024-10-31 ucrt)\n## Platform: x86_64-w64-mingw32/x64\n## Running under: Windows 11 x64 (build 26100)\n## \n## Matrix products: default\n## \n## \n## locale:\n## [1] LC_COLLATE=Portuguese_Brazil.utf8  LC_CTYPE=Portuguese_Brazil.utf8   \n## [3] LC_MONETARY=Portuguese_Brazil.utf8 LC_NUMERIC=C                      \n## [5] LC_TIME=Portuguese_Brazil.utf8    \n## \n## time zone: America/Sao_Paulo\n## tzcode source: internal\n## \n## attached base packages:\n## [1] stats     graphics  grDevices utils     datasets  methods   base     \n## \n## other attached packages:\n##  [1] patchwork_1.3.0  ggthemes_5.1.0   corrplot_0.95    metan_1.19.0    \n##  [5] FactoMineR_2.11  factoextra_1.0.7 lubridate_1.9.4  forcats_1.0.0   \n##  [9] stringr_1.5.1    dplyr_1.1.4      purrr_1.0.2      readr_2.1.5     \n## [13] tidyr_1.3.1      tibble_3.2.1     ggplot2_3.5.1    tidyverse_2.0.0 \n## [17] rio_1.2.3       \n## \n## loaded via a namespace (and not attached):\n##  [1] Rdpack_2.6.2         sandwich_3.1-1       readxl_1.4.3        \n##  [4] rlang_1.1.5          magrittr_2.0.3       multcomp_1.4-26     \n##  [7] compiler_4.4.2       mgcv_1.9-1           vctrs_0.6.5         \n## [10] pkgconfig_2.0.3      fastmap_1.2.0        backports_1.5.0     \n## [13] labeling_0.4.3       utf8_1.2.4           rmarkdown_2.29      \n## [16] tzdb_0.5.0           nloptr_2.1.1         xfun_0.50           \n## [19] jsonlite_1.9.1       flashClust_1.01-2    tweenr_2.0.3        \n## [22] broom_1.0.7          cluster_2.1.6        R6_2.6.1            \n## [25] stringi_1.8.4        RColorBrewer_1.1-3   GGally_2.2.1        \n## [28] car_3.1-3            boot_1.3-31          cellranger_1.1.0    \n## [31] numDeriv_2016.8-1.1  estimability_1.5.1   Rcpp_1.0.14         \n## [34] knitr_1.49           zoo_1.8-12           R.utils_2.12.3      \n## [37] Matrix_1.7-1         splines_4.4.2        timechange_0.3.0    \n## [40] tidyselect_1.2.1     abind_1.4-8          rstudioapi_0.17.1   \n## [43] yaml_2.3.10          codetools_0.2-20     lattice_0.22-6      \n## [46] lmerTest_3.1-3       plyr_1.8.9           withr_3.0.2         \n## [49] coda_0.19-4.1        evaluate_1.0.3       survival_3.7-0      \n## [52] ggstats_0.8.0        polyclip_1.10-7      pillar_1.10.1       \n## [55] ggpubr_0.6.0         carData_3.0-5        DT_0.33             \n## [58] reformulas_0.4.0     generics_0.1.3       mathjaxr_1.6-0      \n## [61] hms_1.1.3            munsell_0.5.1        scales_1.3.0        \n## [64] minqa_1.2.8          xtable_1.8-4         leaps_3.2           \n## [67] glue_1.8.0           emmeans_1.10.6       scatterplot3d_0.3-44\n## [70] tools_4.4.2          lme4_1.1-36          ggsignif_0.6.4      \n## [73] mvtnorm_1.3-3        grid_4.4.2           rbibutils_2.3       \n## [76] colorspace_2.1-1     nlme_3.1-166         ggforce_0.4.2       \n## [79] Formula_1.2-5        cli_3.6.4            gtable_0.3.6        \n## [82] R.methodsS3_1.8.2    rstatix_0.7.2        digest_0.6.37       \n## [85] ggrepel_0.9.6        TH.data_1.1-3        htmlwidgets_1.6.4   \n## [88] farver_2.1.2         htmltools_0.5.8.1    R.oo_1.27.0         \n## [91] lifecycle_1.0.4      multcompView_0.1-10  MASS_7.3-61",
    "crumbs": [
      "About",
      "05: Análise de Correlação e PCA em Genótipos de Linhaça (Linum usitatissimum L.) Dourada e Marrom"
    ]
  },
  {
    "objectID": "03_interacao.html",
    "href": "03_interacao.html",
    "title": "03: Adaptabilidade e estabilidade de genótipos experimentais de linhaça cultivados em ambientes contrastantes de Santa Catarina",
    "section": "",
    "text": "library(rio)\nlibrary(tidyverse)\nlibrary(metan)\nlibrary(ggridges)\nlibrary(ggthemes)\nlibrary(patchwork)\n\ndf &lt;- import_list(\"data/progresso.xlsx\")\ng2022 &lt;- df$`2022` |&gt; select(GEN, RGPLA) |&gt; rename(A2022 = RGPLA)\ng2023 &lt;- df$`2023` |&gt; select(GEN, RGPLA) |&gt; rename(A2023 = RGPLA)\ng2024 &lt;- df$`2024` |&gt; select(GEN, RGPLA) |&gt; rename(A2024 = RGPLA)\n\n\ndfge &lt;- \n  reduce(list(g2024, g2023, g2022), left_join) |&gt; \n  remove_rows_na()\n\ndf_ggplot &lt;- \n  dfge |&gt; \n  pivot_longer(-GEN, names_to = \"AMB\", values_to = \"RGPLA\")",
    "crumbs": [
      "About",
      "03: Adaptabilidade e estabilidade de genótipos experimentais de linhaça cultivados em ambientes contrastantes de Santa Catarina"
    ]
  },
  {
    "objectID": "03_interacao.html#método-wricke",
    "href": "03_interacao.html#método-wricke",
    "title": "03: Adaptabilidade e estabilidade de genótipos experimentais de linhaça cultivados em ambientes contrastantes de Santa Catarina",
    "section": "\n4.1 Método Wricke",
    "text": "4.1 Método Wricke\nWRICKE, G. Zur Berechnung der Ökovalenz bei Sommerweizen und Hafer. Zeitschrift für Pflanzenzüchtung, v.52, p.127-138, 1965.\n\necovalencia &lt;- \n  apply(mat_ef, 1, function(x){\n    sum(x^2)\n  })\neco &lt;- data.frame(ecovalencia) |&gt; rownames_to_column(\"GEN\")",
    "crumbs": [
      "About",
      "03: Adaptabilidade e estabilidade de genótipos experimentais de linhaça cultivados em ambientes contrastantes de Santa Catarina"
    ]
  },
  {
    "objectID": "03_interacao.html#método-waas",
    "href": "03_interacao.html#método-waas",
    "title": "03: Adaptabilidade e estabilidade de genótipos experimentais de linhaça cultivados em ambientes contrastantes de Santa Catarina",
    "section": "\n4.2 Método WAAS",
    "text": "4.2 Método WAAS\nOLIVOTO, T. et al. Mean Performance and Stability in Multi‐Environment Trials I: Combining Features of AMMI and BLUP Techniques. Agronomy Journal, v. 111, n. 6, p. 2949–2960, 2019.\n\nwaas_vals &lt;- \n  get_model_data(mod) |&gt; \n  rename(WAAS = RGPLA)\n\nstabs &lt;- left_join(waas_vals, eco)\nggplot(stabs, aes(WAAS, ecovalencia)) +\n  geom_point()\n\n\n\n\n\n\n\ncor(stabs$WAAS, stabs$ecovalencia)\n## [1] 0.9160285",
    "crumbs": [
      "About",
      "03: Adaptabilidade e estabilidade de genótipos experimentais de linhaça cultivados em ambientes contrastantes de Santa Catarina"
    ]
  },
  {
    "objectID": "01_pliman_capsulas.html",
    "href": "01_pliman_capsulas.html",
    "title": "01: Protocolo para contagem automatizada de cápsulas de linhaça utilizando o pacote R pliman",
    "section": "",
    "text": "1 Pacotes\n\nlibrary(pliman)\nlibrary(tidyverse)\nlibrary(purrr)\nlibrary(rio)\nlibrary(ggthemes)\nimg &lt;- image_import(\"figs/capsulas/a1426e78-6bc2-4ce4-9d58-0777384c066d.jpg\", resize = 50)\nbin &lt;- image_binary(img, index = \"GRAY\")[[1]]\n\n\n\n\n\n\nfmed &lt;- image_filter(bin, size = 3)\nboa &lt;- image_opening(fmed, size = 20)\nimage_combine(img, bin, fmed, boa, ncol = 2)\n\n\n\n\n\n\n\n\n2 Contagem manual\n\npick_count(img)\n\n\n3 Analisar as fotos\n\n4 Processamento em lote (validação)\n\nres_val &lt;- \n  analyze_objects(\n    pattern = \"-\",\n    resize = 50,\n    dir_original = \"figs/capsulas/\",\n    dir_processed = \"figs/proc\",\n    index = \"GRAY\",\n    marker = \"point\",\n    marker_col = \"red\",\n    # save_image = TRUE,\n    opening = 15,\n    filter = 3,\n    parallel = TRUE,\n    workers = 6\n  )\nexport(res_val$count, \"data/capsulas.xlsx\")\nexport(res_val$results, \"data/capsulas_raw.csv\")\nres_graos &lt;- \n  analyze_objects(\n    pattern = \"-\",\n    resize = 50,\n    dir_original = \"figs/graos/\",\n    dir_processed = \"figs/proc_graos\",\n    index = \"GRAY\",\n    marker = \"point\",\n    marker_col = \"red\",\n    save_image = TRUE,\n    marker_size = 1,\n    show_contour = FALSE,\n    opening = 7,\n    parallel = TRUE,\n    workers = 6\n  )\nexport(res_graos$count, \"data/graos.xlsx\")\nexport(res_graos$results, \"data/graos_raw.csv\")\n\n\n5 Cenário 100%\n\n# set_wd_here()\n\n# CENÁRIO COM IMAGENS ORIGINAIS\ncenarios &lt;- expand_grid(open = c(0, 25),\n                        filt = c(0, 5))\nresults_100 &lt;- \n  map_dfr(1:4, function(i){\n    tp &lt;- \n      system.time(\n        res &lt;- \n          analyze_objects(\n            pattern = \"-\",\n            dir_original = \"figs/R100/\",\n            index = \"GRAY\",\n            opening = cenarios[[i, 1]],\n            filter = cenarios[[i, 2]],\n            plot = FALSE\n          )\n      )\n    res$count |&gt; \n      mutate(filter = cenarios[[i, 2]],\n             opening = cenarios[[i, 1]],\n             resolucao = \"100\",\n             tempo = as.numeric(tp)[3])\n    \n  })\n\n\n\n# 50% DA RESOLUÇÃO\n\ncenarios &lt;- expand_grid(open = c(0, 15),\n                        filt = c(0, 3))\n\nresults_50 &lt;- \n  map_dfr(1:4, function(i){\n    tp &lt;- \n      system.time(\n        res &lt;- \n          analyze_objects(\n            pattern = \"-\",\n            dir_original = \"figs/R50/\",\n            index = \"GRAY\",\n            opening = cenarios[[i, 1]],\n            filter = cenarios[[i, 2]],\n            plot = FALSE\n          )\n      )\n    res$count |&gt; \n      mutate(filter = cenarios[[i, 2]],\n             opening = cenarios[[i, 1]],\n             resolucao = \"50\",\n             tempo = as.numeric(tp)[3])\n    \n  })\n\n# 25% DA RESOLUÇÃO\ncenarios &lt;- expand_grid(open = c(0, 5),\n                        filt = c(0, 2))\n\nresults_25 &lt;- \n  map_dfr(1:4, function(i){\n    tp &lt;- \n      system.time(\n        res &lt;- \n          analyze_objects(\n            pattern = \"-\",\n            dir_original = \"figs/R25/\",\n            index = \"GRAY\",\n            opening = cenarios[[i, 1]],\n            filter = cenarios[[i, 2]],\n            plot = FALSE\n          )\n      )\n    res$count |&gt; \n      mutate(filter = cenarios[[i, 2]],\n             opening = cenarios[[i, 1]],\n             resolucao = \"25\",\n             tempo = as.numeric(tp)[3])\n    \n  })\n\nfinal &lt;- bind_rows(results_100, results_50, results_25)\nexport(final, \"dados_cenarios.xlsx\")\n\n\n6 Concordância\n$$ _c = \n$$\nA Concordância de Lin ou Coeficiente de Correlação de Concordância (CCC) é uma métrica que avalia simultaneamente a precisão e a acurácia entre duas variáveis contínuas. Ela é frequentemente utilizada para medir o grau de concordância entre dois métodos de mensuração ou entre observações pareadas.\nEnquanto o coeficiente de correlação de Pearson r mede apenas a precisão (a força da associação linear), o CCC incorpora também a acurácia (quão próximo os dados estão da linha de identidade.\n\n\ndf &lt;- \n  import(\"data/acuracia_capsulas.xlsx\") |&gt; \n  metan::as_factor(filter:resolucao) %&gt;% \n  mutate(filter = paste0(\"filter = \", filter),\n         opening = paste0(\"opening = \", opening))\n\n# Agora computa as métricas (vou computar elas depois de novo para colocar nos gráficos)\ndf |&gt; \n  group_by(filter, opening, resolucao) %&gt;%\n  ccc(real, predito) %&gt;%\n  mutate(rho = paste0(\"rho[c]:~\", round(ccc, 4)),\n         rmse = paste0(\"RMSE:~\", round(rmse, 4)),\n         r = paste0(\"r:~~~\", round(r, 4)))\n## # A tibble: 12 × 7\n##    filter     opening      resolucao r             ccc rmse          rho        \n##    &lt;chr&gt;      &lt;chr&gt;        &lt;fct&gt;     &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;      \n##  1 filter = 0 opening = 0  100       r:~~~0.9764 0.960 RMSE:~18.2303 rho[c]:~0.…\n##  2 filter = 0 opening = 0  25        r:~~~0.9822 0.964 RMSE:~17.4666 rho[c]:~0.…\n##  3 filter = 0 opening = 0  50        r:~~~0.9698 0.927 RMSE:~26.0669 rho[c]:~0.…\n##  4 filter = 0 opening = 15 50        r:~~~0.9945 0.993 RMSE:~7.2757  rho[c]:~0.…\n##  5 filter = 0 opening = 25 100       r:~~~0.9964 0.996 RMSE:~5.5856  rho[c]:~0.…\n##  6 filter = 0 opening = 5  25        r:~~~0.9912 0.983 RMSE:~11.7958 rho[c]:~0.…\n##  7 filter = 2 opening = 0  25        r:~~~0.9917 0.988 RMSE:~9.6294  rho[c]:~0.…\n##  8 filter = 2 opening = 5  25        r:~~~0.9945 0.993 RMSE:~7.4692  rho[c]:~0.…\n##  9 filter = 3 opening = 0  50        r:~~~0.986  0.975 RMSE:~14.4058 rho[c]:~0.…\n## 10 filter = 3 opening = 15 50        r:~~~0.9973 0.997 RMSE:~4.5118  rho[c]:~0.…\n## 11 filter = 5 opening = 0  100       r:~~~0.9872 0.978 RMSE:~13.2471 rho[c]:~0.…\n## 12 filter = 5 opening = 25 100       r:~~~0.9971 0.996 RMSE:~5.3103  rho[c]:~0.…\n\n\n7 Gráficos\n\n# cria uma nova coluna em cada resolução contendo os valores\ndfvalid &lt;- \n  df |&gt; \n  group_by(resolucao) %&gt;% \n  nest() |&gt; \n  mutate(ccc = map(data, function(x){\n    x |&gt; \n      group_by(filter, opening) %&gt;%\n      ccc(real, predito) |&gt; \n      mutate(\n        ccc = paste0(\"rho[c]:~\", round(ccc, 3)),\n        rmse = paste0(\"RMSE:~\", round(rmse, 3)),\n        r = paste0(\"r:~~~\", round(r, 3)))\n    \n  }))\n\n# 100# \nggplot(dfvalid$data[[1]], aes(predito, real)) +\n  geom_point(alpha = 0.5, color = \"darkgreen\") +\n  facet_grid(filter ~ opening) +\n  geom_abline(intercept = 0, slope = 1, color = \"red\") +\n  geom_text(aes(label=ccc),\n            x = 5,\n            y = 360,\n            hjust = 0,\n            size = 3,\n            data = dfvalid$ccc[[1]],\n            parse = TRUE) +\n  geom_text(aes(label=rmse),\n            x = 5,\n            y = 340,\n            hjust = 0,\n            size = 3,\n            data = dfvalid$ccc[[1]],\n            parse = TRUE) +\n  geom_text(aes(label=r),\n            x = 5,\n            y = 320,\n            hjust = 0,\n            size = 3,\n            data = dfvalid$ccc[[1]],\n            parse = TRUE) +\n  theme_stata() +\n  coord_equal() +\n  xlim(0, 400) +\n  ylim(0, 400) +\n  theme(panel.grid.major.y  = element_blank()) +\n  labs(x = \"Valor predito\",\n       y = \"Valor observado\")\n\n\n\n\n\n\n\n# ggsave(\"figs/plot_acuracia_100.jpg\",\n#        width = 6,\n#        height = 6)\n\n## 50%\nggplot(dfvalid$data[[2]], aes(predito, real)) +\n  geom_point(alpha = 0.5, color = \"darkgreen\") +\n  geom_abline(intercept = 0, slope = 1, color = \"red\") +\n  facet_grid(filter ~ opening) +\n  geom_text(aes(label=ccc),\n            x = 5,\n            y = 360,\n            hjust = 0,\n            size = 3,\n            data = dfvalid$ccc[[2]],\n            parse = TRUE) +\n  geom_text(aes(label=rmse),\n            x = 5,\n            y = 340,\n            hjust = 0,\n            size = 3,\n            data = dfvalid$ccc[[2]],\n            parse = TRUE) +\n  geom_text(aes(label=r),\n            x = 5,\n            y = 320,\n            hjust = 0,\n            size = 3,\n            data = dfvalid$ccc[[2]],\n            parse = TRUE) +\n  theme_stata() +\n  coord_equal() +\n  xlim(0, 400) +\n  ylim(0, 400) +\n  theme(panel.grid.major.y  = element_blank()) +\n  labs(x = \"Valor predito\",\n       y = \"Valor observado\")\n\n\n\n\n\n\n\n# ggsave(\"figs/plot_acuracia_50.jpg\",\n#        width = 6,\n#        height = 6)\n\n# 25%\nggplot(dfvalid$data[[3]], aes(predito, real)) +\n  geom_point(alpha = 0.5, color = \"darkgreen\") +\n  geom_abline(intercept = 0, slope = 1, color = \"red\") +\n  facet_grid(filter ~ opening) +\n  geom_text(aes(label=ccc),\n            x = 5,\n            y = 360,\n            hjust = 0,\n            size = 3,\n            data = dfvalid$ccc[[3]],\n            parse = TRUE) +\n  geom_text(aes(label=rmse),\n            x = 5,\n            y = 340,\n            hjust = 0,\n            size = 3,\n            data = dfvalid$ccc[[3]],\n            parse = TRUE) +\n  geom_text(aes(label=r),\n            x = 5,\n            y = 320,\n            hjust = 0,\n            size = 3,\n            data = dfvalid$ccc[[3]],\n            parse = TRUE) +\n  theme_stata() +\n  coord_equal() +\n  xlim(0, 400) +\n  ylim(0, 400) +\n  theme(panel.grid.major.y  = element_blank()) +\n  labs(x = \"Valor predito\",\n       y = \"Valor observado\") \n\n\n\n\n\n\n# ggsave(\"figs/plot_acuracia_25.jpg\",\n#        width = 6,\n#        height = 6)\n\n\n8 Section info\n\nsessionInfo()\n## R version 4.4.2 (2024-10-31 ucrt)\n## Platform: x86_64-w64-mingw32/x64\n## Running under: Windows 11 x64 (build 26100)\n## \n## Matrix products: default\n## \n## \n## locale:\n## [1] LC_COLLATE=Portuguese_Brazil.utf8  LC_CTYPE=Portuguese_Brazil.utf8   \n## [3] LC_MONETARY=Portuguese_Brazil.utf8 LC_NUMERIC=C                      \n## [5] LC_TIME=Portuguese_Brazil.utf8    \n## \n## time zone: America/Sao_Paulo\n## tzcode source: internal\n## \n## attached base packages:\n## [1] stats     graphics  grDevices utils     datasets  methods   base     \n## \n## other attached packages:\n##  [1] ggthemes_5.1.0    rio_1.2.3         lubridate_1.9.4   forcats_1.0.0    \n##  [5] stringr_1.5.1     dplyr_1.1.4       purrr_1.0.2       readr_2.1.5      \n##  [9] tidyr_1.3.1       tibble_3.2.1      ggplot2_3.5.1     tidyverse_2.0.0  \n## [13] pliman_3.0.0.9000\n## \n## loaded via a namespace (and not attached):\n##   [1] Rdpack_2.6.2         DBI_1.2.3            bitops_1.0-9        \n##   [4] readxl_1.4.3         rlang_1.1.5          magrittr_2.0.3      \n##   [7] e1071_1.7-16         compiler_4.4.2       png_0.1-8           \n##  [10] fftwtools_0.9-11     vctrs_0.6.5          pkgconfig_2.0.3     \n##  [13] fastmap_1.2.0        mapedit_0.6.0        labeling_0.4.3      \n##  [16] leafem_0.2.3         utf8_1.2.4           promises_1.3.2      \n##  [19] rmarkdown_2.29       tzdb_0.5.0           nloptr_2.1.1        \n##  [22] xfun_0.50            satellite_1.0.5      jsonlite_1.9.1      \n##  [25] later_1.3.2          mapview_2.11.2       tweenr_2.0.3        \n##  [28] jpeg_0.1-10          tiff_0.1-12          terra_1.8-29        \n##  [31] R6_2.6.1             stringi_1.8.4        RColorBrewer_1.1-3  \n##  [34] GGally_2.2.1         boot_1.3-31          cellranger_1.1.0    \n##  [37] numDeriv_2016.8-1.1  Rcpp_1.0.14          knitr_1.49          \n##  [40] R.utils_2.12.3       base64enc_0.1-3      httpuv_1.6.15       \n##  [43] Matrix_1.7-1         splines_4.4.2        timechange_0.3.0    \n##  [46] tidyselect_1.2.1     rstudioapi_0.17.1    abind_1.4-8         \n##  [49] yaml_2.3.10          EBImage_4.46.0       codetools_0.2-20    \n##  [52] lmerTest_3.1-3       lattice_0.22-6       plyr_1.8.9          \n##  [55] shiny_1.10.0         withr_3.0.2          evaluate_1.0.3      \n##  [58] sf_1.0-19            ggstats_0.8.0        units_0.8-7         \n##  [61] proxy_0.4-27         polyclip_1.10-7      exactextractr_0.10.0\n##  [64] pillar_1.10.1        KernSmooth_2.23-24   stats4_4.4.2        \n##  [67] reformulas_0.4.0     generics_0.1.3       sp_2.2-0            \n##  [70] mathjaxr_1.6-0       RCurl_1.98-1.16      hms_1.1.3           \n##  [73] munsell_0.5.1        scales_1.3.0         minqa_1.2.8         \n##  [76] xtable_1.8-4         class_7.3-22         glue_1.8.0          \n##  [79] metan_1.19.0         tools_4.4.2          lme4_1.1-36         \n##  [82] locfit_1.5-9.10      grid_4.4.2           rbibutils_2.3       \n##  [85] crosstalk_1.2.1      colorspace_2.1-1     nlme_3.1-166        \n##  [88] patchwork_1.3.0      raster_3.6-31        ggforce_0.4.2       \n##  [91] cli_3.6.4            gtable_0.3.6         R.methodsS3_1.8.2   \n##  [94] digest_0.6.37        BiocGenerics_0.50.0  classInt_0.4-11     \n##  [97] ggrepel_0.9.6        htmlwidgets_1.6.4    farver_2.1.2        \n## [100] R.oo_1.27.0          htmltools_0.5.8.1    lifecycle_1.0.4     \n## [103] leaflet_2.2.2        mime_0.13            MASS_7.3-61",
    "crumbs": [
      "About",
      "01: Protocolo para contagem automatizada de cápsulas de linhaça utilizando o pacote R pliman"
    ]
  },
  {
    "objectID": "04_MGIDI.html",
    "href": "04_MGIDI.html",
    "title": "04: Índice de seleção MGIDI na avaliação de genótipos superiores de linhaça",
    "section": "",
    "text": "library(rio)\nlibrary(tidyverse)\nlibrary(factoextra)\nlibrary(metan)\nlibrary(ggthemes)\nlibrary(factoextra)\nlibrary(FactoMineR)\nlibrary(patchwork)\nlibrary(AgroR)",
    "crumbs": [
      "About",
      "04: Índice de seleção MGIDI na avaliação de genótipos superiores de linhaça"
    ]
  },
  {
    "objectID": "04_MGIDI.html#sem-pesos",
    "href": "04_MGIDI.html#sem-pesos",
    "title": "04: Índice de seleção MGIDI na avaliação de genótipos superiores de linhaça",
    "section": "\n4.1 Sem pesos",
    "text": "4.1 Sem pesos\n\nideotipo &lt;- c(\"70, h, h, 8, h, h, h, h, h\")\n# sem pesos\nmod_mgidi &lt;- \n  mgidi(\n    dfgens,\n    ideotype = ideotipo,\n    SI = 25\n  )\n## \n## -------------------------------------------------------------------------------\n## Principal Component Analysis\n## -------------------------------------------------------------------------------\n## # A tibble: 9 × 4\n##   PC    Eigenvalues `Variance (%)` `Cum. variance (%)`\n##   &lt;chr&gt;       &lt;dbl&gt;          &lt;dbl&gt;               &lt;dbl&gt;\n## 1 PC1          4.92          54.7                 54.7\n## 2 PC2          1.36          15.1                 69.8\n## 3 PC3          0.86           9.55                79.4\n## 4 PC4          0.74           8.26                87.6\n## 5 PC5          0.59           6.61                94.2\n## 6 PC6          0.45           5.05                99.3\n## 7 PC7          0.05           0.58                99.9\n## 8 PC8          0.01           0.08               100. \n## 9 PC9          0              0.03               100  \n## -------------------------------------------------------------------------------\n## Factor Analysis - factorial loadings after rotation-\n## -------------------------------------------------------------------------------\n## # A tibble: 9 × 5\n##   VAR     FA1   FA2 Communality Uniquenesses\n##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;\n## 1 AP    -0.49  0.45        0.44         0.56\n## 2 CP     0.04  0.79        0.62         0.38\n## 3 MC    -0.88  0.41        0.95         0.05\n## 4 MG    -0.94  0.3         0.97         0.03\n## 5 NR    -0.13  0.64        0.43         0.57\n## 6 NC    -0.79  0.51        0.88         0.12\n## 7 NG    -0.91  0.32        0.93         0.07\n## 8 MMG   -0.58 -0.07        0.34         0.66\n## 9 ICC   -0.79 -0.3         0.72         0.28\n## -------------------------------------------------------------------------------\n## Comunalit Mean: 0.6983905 \n## -------------------------------------------------------------------------------\n## Selection differential \n## -------------------------------------------------------------------------------\n## # A tibble: 9 × 8\n##   VAR   Factor      Xo      Xs       SD SDperc sense     goal\n##   &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;\n## 1 AP    FA1     65.4    67.3     1.94     2.97 decrease     0\n## 2 MC    FA1      3.90    5.93    2.03    52.1  increase   100\n## 3 MG    FA1      2.72    4.26    1.54    56.7  decrease     0\n## 4 NC    FA1     88.3   132.     44.2     50.0  increase   100\n## 5 NG    FA1    535.    813.    279.      52.1  increase   100\n## 6 MMG   FA1      4.99    5.22    0.231    4.63 increase   100\n## 7 ICC   FA1      0.670   0.699   0.0295   4.41 increase   100\n## 8 CP    FA2     29.1    32.2     3.07    10.6  increase   100\n## 9 NR    FA2      4.72    5.30    0.587   12.4  increase   100\n## ------------------------------------------------------------------------------\n## Selected genotypes\n## -------------------------------------------------------------------------------\n## G13 ST_PIONEIRA G74 G69D G215 G23 G12 G228 G4 G72\n## -------------------------------------------------------------------------------\npmgidi_sp &lt;- plot(mod_mgidi, SI = 25)",
    "crumbs": [
      "About",
      "04: Índice de seleção MGIDI na avaliação de genótipos superiores de linhaça"
    ]
  },
  {
    "objectID": "04_MGIDI.html#com-pesos",
    "href": "04_MGIDI.html#com-pesos",
    "title": "04: Índice de seleção MGIDI na avaliação de genótipos superiores de linhaça",
    "section": "\n4.2 Com pesos",
    "text": "4.2 Com pesos\n\nmod_mgidi_pesos &lt;- \n  mgidi(\n    dfgens,\n    ideotype = ideotipo,\n    weights = c(1, 1, 5, 1, 1, 1, 1, 1, 1),\n    SI = 25\n  )\n## \n## -------------------------------------------------------------------------------\n## Principal Component Analysis\n## -------------------------------------------------------------------------------\n## # A tibble: 9 × 4\n##   PC    Eigenvalues `Variance (%)` `Cum. variance (%)`\n##   &lt;chr&gt;       &lt;dbl&gt;          &lt;dbl&gt;               &lt;dbl&gt;\n## 1 PC1          4.92          54.7                 54.7\n## 2 PC2          1.36          15.1                 69.8\n## 3 PC3          0.86           9.55                79.4\n## 4 PC4          0.74           8.26                87.6\n## 5 PC5          0.59           6.61                94.2\n## 6 PC6          0.45           5.05                99.3\n## 7 PC7          0.05           0.58                99.9\n## 8 PC8          0.01           0.08               100. \n## 9 PC9          0              0.03               100  \n## -------------------------------------------------------------------------------\n## Factor Analysis - factorial loadings after rotation-\n## -------------------------------------------------------------------------------\n## # A tibble: 9 × 5\n##   VAR     FA1   FA2 Communality Uniquenesses\n##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;\n## 1 AP    -0.49  0.45        0.44         0.56\n## 2 CP     0.04  0.79        0.62         0.38\n## 3 MC    -0.88  0.41        0.95         0.05\n## 4 MG    -0.94  0.3         0.97         0.03\n## 5 NR    -0.13  0.64        0.43         0.57\n## 6 NC    -0.79  0.51        0.88         0.12\n## 7 NG    -0.91  0.32        0.93         0.07\n## 8 MMG   -0.58 -0.07        0.34         0.66\n## 9 ICC   -0.79 -0.3         0.72         0.28\n## -------------------------------------------------------------------------------\n## Comunalit Mean: 0.6983905 \n## -------------------------------------------------------------------------------\n## Selection differential \n## -------------------------------------------------------------------------------\n## # A tibble: 9 × 8\n##   VAR   Factor      Xo      Xs       SD SDperc sense     goal\n##   &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;\n## 1 AP    FA1     65.4    67.0     1.59     2.44 decrease     0\n## 2 MC    FA1      3.90    6.08    2.18    55.8  increase   100\n## 3 MG    FA1      2.72    4.39    1.67    61.5  decrease     0\n## 4 NC    FA1     88.3   131.     42.4     48.0  increase   100\n## 5 NG    FA1    535.    828.    293.      54.8  increase   100\n## 6 MMG   FA1      4.99    5.33    0.338    6.79 increase   100\n## 7 ICC   FA1      0.670   0.713   0.0430   6.42 increase   100\n## 8 CP    FA2     29.1    30.9     1.85     6.36 increase   100\n## 9 NR    FA2      4.72    5.48    0.762   16.2  increase   100\n## ------------------------------------------------------------------------------\n## Selected genotypes\n## -------------------------------------------------------------------------------\n## G13 G69D ST_PIONEIRA G72 G74 G215 G4 G23 G29 G228\n## -------------------------------------------------------------------------------\n\npmgidi_cp &lt;- plot(mod_mgidi_pesos)\npmgidi_sp + pmgidi_cp +\n  plot_layout(guides = \"collect\") & theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n# ggsave(\"figs/mgidi.jpg\",\n#        width = 14,\n#        height = 6)",
    "crumbs": [
      "About",
      "04: Índice de seleção MGIDI na avaliação de genótipos superiores de linhaça"
    ]
  },
  {
    "objectID": "04_MGIDI.html#gen-comuns",
    "href": "04_MGIDI.html#gen-comuns",
    "title": "04: Índice de seleção MGIDI na avaliação de genótipos superiores de linhaça",
    "section": "\n4.3 Gen comuns",
    "text": "4.3 Gen comuns\n\ngensp &lt;- sel_gen(mod_mgidi)\ngencp &lt;- sel_gen(mod_mgidi_pesos)\n\nselected &lt;-\n  venn_plot(gencp,\n            gensp, \n            show_elements = TRUE,\n            split_each  = 1, \n            fill = pliman::ggplot_color(2),\n            split_labels = TRUE,\n            names = c(\"Com peso\", \"Sem peso\")) +   \n  theme_stata(base_size = 14) +\n  theme(panel.grid.major = element_blank(),\n        axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        axis.title = element_blank(),\n        axis.ticks.x = element_blank(),\n        axis.ticks.y = element_blank()) + \n    labs(x = NULL,\n         y = NULL)\n\n# ggsave(\"figs/sel_gen_mgidi.jpg\",\n#        width = 8,\n#        height = 6)",
    "crumbs": [
      "About",
      "04: Índice de seleção MGIDI na avaliação de genótipos superiores de linhaça"
    ]
  }
]