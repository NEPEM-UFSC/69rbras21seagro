resultado <- data.frame(
parametro = c("var_gen", "var_planta", "var_res", "n_media", "H2", "LRT", "p_genotipo"),
valor = c(var_gen, var_planta, var_res, n, H2, ran$Chisq[1], ran$p[1])
)
names(resultado)[2] <- trait
return(resultado)
})
# Juntar os resultados por parâmetro
df_final <-
resultados %>%
reduce(full_join, by = "parametro")
return(df_final)
}
variaveis <- c("AP", "AC", "CP", "MC", "MG", "MMG", "ICC", "NR", "NC", "NG")
vals <- vcomp(df, variaveis)
export(vals, "data/vcomp.xlsx")
df_vcomp <-
vals |>
slice(1:3) |>
pivot_longer(-parametro) |>
mutate(
value = case_when(
parametro == "var_planta" ~ value  / 5,
parametro == "var_res" ~ value  / 5,
TRUE ~value
)
)
vcmp <-
ggplot(df_vcomp, aes(name, value))+
geom_col(aes(fill = parametro), position = "fill",
color = "black") +
theme_stata(base_size = 14) +
scale_y_continuous(expand = expansion(0)) +
scale_x_discrete(expand = expansion(0)) +
theme(axis.text.y = element_text(angle = 0)) +
scale_fill_manual(
values = c("var_gen" = "#F8766D", "var_planta" = "#00BA38", "var_res" = "#619CFF"),
labels = c(
"var_gen" = expression(sigma[g]^2),
"var_planta" = expression(sigma[g(p)]^2),
"var_res" = expression(sigma[e]^2)
)
) +
labs(x = "Caracteres",
y = "Proporção da variância fenotípica",
fill = "")
vcmp
df_vcomp
vcmp <-
ggplot(df_vcomp, aes(name, value))+
geom_col(aes(fill = parametro), position = "fill",
color = "black") +
geom_point(data = df_vcomp |> filter(parametro == "H2"),
aes(y = value, x = name), size = 3, color = "black") +
theme_stata(base_size = 14) +
scale_y_continuous(expand = expansion(0)) +
scale_x_discrete(expand = expansion(0)) +
theme(axis.text.y = element_text(angle = 0)) +
scale_fill_manual(
values = c("var_gen" = "#F8766D", "var_planta" = "#00BA38", "var_res" = "#619CFF"),
labels = c(
"var_gen" = expression(sigma[g]^2),
"var_planta" = expression(sigma[g(p)]^2),
"var_res" = expression(sigma[e]^2)
)
) +
labs(x = "Caracteres",
y = "Proporção da variância fenotípica",
fill = "")
vcmp
data = df_vcomp |> filter(parametro == "H2")
data = df_vcomp |> filter(parametro == "H2")
df_vcomp |> filter(parametro == "H2")
df_vcomp |> filter(parametro == "H2")
vals
df_vcomp
vals
dfh2 <-
vals |>
slice(5)
dfh2
dfh2 <-
vals |>
slice(5) |>
pivot_longer(-parametro)
dfh2
vcmp <-
ggplot(df_vcomp, aes(name, value))+
geom_col(aes(fill = parametro), position = "fill",
color = "black") +
geom_point(data = dfh2,
aes(y = value, x = name), size = 3, color = "black") +
theme_stata(base_size = 14) +
scale_y_continuous(expand = expansion(0)) +
scale_x_discrete(expand = expansion(0)) +
theme(axis.text.y = element_text(angle = 0)) +
scale_fill_manual(
values = c("var_gen" = "#F8766D", "var_planta" = "#00BA38", "var_res" = "#619CFF"),
labels = c(
"var_gen" = expression(sigma[g]^2),
"var_planta" = expression(sigma[g(p)]^2),
"var_res" = expression(sigma[e]^2)
)
) +
labs(x = "Caracteres",
y = "Proporção da variância fenotípica",
fill = "")
vcmp
vcmp <-
ggplot(df_vcomp, aes(name, value))+
geom_col(aes(fill = parametro), position = "fill",
color = "black") +
geom_point(data = dfh2,
aes(y = value, x = name), size = 3,
shape = 21) +
theme_stata(base_size = 14) +
scale_y_continuous(expand = expansion(0)) +
scale_x_discrete(expand = expansion(0)) +
theme(axis.text.y = element_text(angle = 0)) +
scale_fill_manual(
values = c("var_gen" = "#F8766D", "var_planta" = "#00BA38", "var_res" = "#619CFF"),
labels = c(
"var_gen" = expression(sigma[g]^2),
"var_planta" = expression(sigma[g(p)]^2),
"var_res" = expression(sigma[e]^2)
)
) +
labs(x = "Caracteres",
y = "Proporção da variância fenotípica",
fill = "")
# vcmp <-
ggplot(df_vcomp, aes(name, value))+
geom_col(aes(fill = parametro), position = "fill",
color = "black") +
geom_point(data = dfh2,
aes(y = value, x = name), size = 3,
shape = 21) +
theme_stata(base_size = 14) +
scale_y_continuous(expand = expansion(0)) +
scale_x_discrete(expand = expansion(0)) +
theme(axis.text.y = element_text(angle = 0)) +
scale_fill_manual(
values = c("var_gen" = "#F8766D", "var_planta" = "#00BA38", "var_res" = "#619CFF"),
labels = c(
"var_gen" = expression(sigma[g]^2),
"var_planta" = expression(sigma[g(p)]^2),
"var_res" = expression(sigma[e]^2)
)
) +
labs(x = "Caracteres",
y = "Proporção da variância fenotípica",
fill = "")
# vcmp <-
ggplot(df_vcomp, aes(name, value))+
geom_col(aes(fill = parametro), position = "fill",
color = "black") +
geom_point(data = dfh2,
aes(y = value, x = name), size = 3,
shape = 23) +
theme_stata(base_size = 14) +
scale_y_continuous(expand = expansion(0)) +
scale_x_discrete(expand = expansion(0)) +
theme(axis.text.y = element_text(angle = 0)) +
scale_fill_manual(
values = c("var_gen" = "#F8766D", "var_planta" = "#00BA38", "var_res" = "#619CFF"),
labels = c(
"var_gen" = expression(sigma[g]^2),
"var_planta" = expression(sigma[g(p)]^2),
"var_res" = expression(sigma[e]^2)
)
) +
labs(x = "Caracteres",
y = "Proporção da variância fenotípica",
fill = "")
df_vcomp
dfh2
# vcmp <-
ggplot(df_vcomp, aes(name, value))+
geom_col(aes(fill = parametro), position = "fill",
color = "black") +
geom_point(data = dfh2,
aes(y = value, x = name),
size = 3,
fill = "darkgreen",
shape = 23) +
theme_stata(base_size = 14) +
scale_y_continuous(expand = expansion(0)) +
scale_x_discrete(expand = expansion(0)) +
theme(axis.text.y = element_text(angle = 0)) +
scale_fill_manual(
values = c("var_gen" = "#F8766D", "var_planta" = "#00BA38", "var_res" = "#619CFF"),
labels = c(
"var_gen" = expression(sigma[g]^2),
"var_planta" = expression(sigma[g(p)]^2),
"var_res" = expression(sigma[e]^2)
)
) +
labs(x = "Caracteres",
y = "Proporção da variância fenotípica",
fill = "")
vcmp <-
ggplot(df_vcomp, aes(name, value))+
geom_col(aes(fill = parametro), position = "fill",
color = "black") +
geom_point(data = dfh2,
aes(y = value, x = name),
size = 3,
fill = "darkgreen",
shape = 23) +
theme_stata(base_size = 14) +
scale_y_continuous(expand = expansion(0)) +
scale_x_discrete(expand = expansion(0)) +
theme(axis.text.y = element_text(angle = 0)) +
scale_fill_manual(
values = c("var_gen" = "#F8766D", "var_planta" = "#00BA38", "var_res" = "#619CFF"),
labels = c(
"var_gen" = expression(sigma[g]^2),
"var_planta" = expression(sigma[g(p)]^2),
"var_res" = expression(sigma[e]^2)
)
) +
labs(x = "Caracteres",
y = "Proporção da variância fenotípica",
fill = "")
box + vcmp +
plot_layout(widths = c(0.6, 0.4)) +
plot_annotation(tag_levels = "a",
tag_suffix = ")")
ggsave("figs/boxplot_vcomp.jpg",
width = 15,
height = 6)
View(df)
View(dfge)
df
df |> mean_by(GEN)
df |> mean_by(GEN) |> summarise(range(MG))
df |> mean_by(GEN) |> arrange(GEN)
df |> mean_by(GEN) |> arrange(MG)
MG<- df |> mean_by(GEN) |> arrange(MG)
View(MG)
library(envirotypeR)
library(tidyverse)
library(ggridges)
library(rio)
library(ggthemes)
library(patchwork)
library(pliman)
env <- c("FLO2022", "FLO2023", "CN2024")
lat <- c(-27.681, -27.681, -27.370)
lon <- c(-48.541, -48.541, -51.204)
start.day <- c("15/04/2022", "15/04/2023", "20/05/2024")
end.day <-   c("30/09/2022", "30/09/2023", "15/11/2024")
as.Date("15/04/2022", format = "%d/%m/%Y") + 150
# climate <-
#   envirotypeR::get_weather(
#     env.id = env,
#     lat = lat,
#     lon = lon,
#     start.day = start.day,
#     end.day = end.day
#   )
#
# export(climate, "data/climate.xlsx")
climate <-
import("data/climate.xlsx") |>
mutate(env = factor(env, c("FLO2022", "FLO2023", "CN2024")))
dfplot <-
climate |>
separate_wider_delim(YYYYMMDD,
names = c("ano", "mes", "dia"),
delim = "-")
ptmin <-
ggplot(dfplot, aes(T2M_MIN, y = mes, fill = after_stat(x))) +
facet_wrap(~env, ncol = 1) +
geom_density_ridges_gradient() +
scale_fill_viridis_c() +
theme(axis.text.y = element_text(angle = 0)) +
labs(x = "Temperatura mínima (ºC)",
y = "Mês do ano",
fill = "(ºC)")
ptmax <-
ggplot(dfplot, aes(T2M_MAX, y = mes, fill = after_stat(x))) +
facet_wrap(~env, ncol = 1) +
geom_density_ridges_gradient() +
scale_fill_viridis_c() +
theme(axis.text.y = element_text(angle = 0)) +
labs(x = "Temperatura máxima (ºC)",
y = "Mês do ano",
fill = "(ºC)")
ptmin <-
ggplot(dfplot, aes(T2M_MIN, y = mes, fill = after_stat(x))) +
facet_wrap(~env, ncol = 1) +
geom_density_ridges_gradient() +
scale_fill_viridis_c() +
theme(axis.text.y = element_text(angle = 0)) +
labs(x = "Temperatura mínima (ºC)",
y = "Mês do ano",
fill = "(ºC)")
ptmax <-
ggplot(dfplot, aes(T2M_MAX, y = mes, fill = after_stat(x))) +
facet_wrap(~env, ncol = 1) +
geom_density_ridges_gradient() +
scale_fill_viridis_c() +
theme(axis.text.y = element_text(angle = 0)) +
labs(x = "Temperatura máxima (ºC)",
y = "Mês do ano",
fill = "(ºC)")
pumre <-
ggplot(dfplot, aes(RH2M, y = mes, fill = after_stat(x))) +
facet_wrap(~env, ncol = 1) +
geom_density_ridges_gradient() +
scale_fill_viridis_c() +
theme(axis.text.y = element_text(angle = 0)) +
labs(x = "Umidade relativa do ar (%)",
y = "Mês do ano",
fill = "%")
ptmin + ptmax + pumre +
plot_annotation(tag_levels = "a", tag_suffix = ")")
ggsave("figs/densidades_temp.jpg", width = 12, height = 8)
pumre <-
ggplot(dfplot, aes(RH2M, y = mes, fill = after_stat(x))) +
facet_wrap(~env, ncol = 1, scales = "free_y") +
geom_density_ridges_gradient() +
scale_fill_viridis_c() +
theme(axis.text.y = element_text(angle = 0)) +
labs(x = "Umidade relativa do ar (%)",
y = "Mês do ano",
fill = "%")
ptmin + ptmax + pumre +
plot_annotation(tag_levels = "a", tag_suffix = ")")
ptmin <-
ggplot(dfplot, aes(T2M_MIN, y = mes, fill = after_stat(x))) +
facet_wrap(~env, ncol = 1, scales = "free_y") +
geom_density_ridges_gradient() +
scale_fill_viridis_c() +
theme(axis.text.y = element_text(angle = 0)) +
labs(x = "Temperatura mínima (ºC)",
y = "Mês do ano",
fill = "(ºC)")
ptmax <-
ggplot(dfplot, aes(T2M_MAX, y = mes, fill = after_stat(x))) +
facet_wrap(~env, ncol = 1, scales = "free_y") +
geom_density_ridges_gradient() +
scale_fill_viridis_c() +
theme(axis.text.y = element_text(angle = 0)) +
labs(x = "Temperatura máxima (ºC)",
y = "Mês do ano",
fill = "(ºC)")
pumre <-
ggplot(dfplot, aes(RH2M, y = mes, fill = after_stat(x))) +
facet_wrap(~env, ncol = 1, scales = "free_y") +
geom_density_ridges_gradient() +
scale_fill_viridis_c() +
theme(axis.text.y = element_text(angle = 0)) +
labs(x = "Umidade relativa do ar (%)",
y = "Mês do ano",
fill = "%")
ptmin + ptmax + pumre +
plot_annotation(tag_levels = "a", tag_suffix = ")")
ggsave("figs/densidades_temp.jpg", width = 12, height = 8)
library(metan)
?performs_ammi
model <- performs_ammi(data_ge, ENV, GEN, REP, resp = c(GY, HM))
# PC1 x PC2 (variable GY)
p1 <- plot_scores(model)
p1
# PC1 x PC2 (variable HM)
plot_scores(model,
var = 2, # or "HM"
type = 2)
?plot_scores
# PC1 x PC2 (variable HM)
plot_scores(model,
var = 2, # or "HM"
size.tex.gen = 0,
type = 2)
# PC1 x PC2 (variable HM)
plot_scores(model,
var = 2, # or "HM"
size.tex.gen = 0,
col.gen = "transparent",
type = 2)
# PC1 x PC2 (variable HM)
plot_scores(model,
var = 2, # or "HM"
size.tex.gen = 0,
type = 2)
ggsave("teste.jpg")
cv_ammif(model)
?cv_ammif
cv_ammif(data_ge, ENV, GEN, REP, resp = GY)
?path_coeff
library(pliman)
library(pliman)
library(rio)
set_wd_here()
# dados
df <- import("qualidade_2024.xlsx")
View(df)
126/3
library(tidyverse)
ggplot(df, aes(Bloco, DPPH)) +
geom_col()
ggplot(df, aes(Bloco, DPPH)) +
geom_bar(stat = "summary")
df2 <- import("qualidade_bruto.xlsx")
View(df2)
df2 |>
pivot_longer(cols = r1:r3)
df2 <-
df2 |>
pivot_longer(cols = r1:r3)
View(df)
View(df2)
df2 <-
df2 |>
pivot_longer(cols = r1:r3) |>
group_by(amostra, gen) |>
summarise(dpph = mean(value))
df2 <- import("qualidade_bruto.xlsx")
df2 <-
df2 |>
pivot_longer(cols = r1:r3) |>
group_by(amostra, gen) |>
summarise(dpph = mean(value))
View(df2)
ggplot(df, aes(Bloco, DPPH, fill = )) +
geom_bar(stat = "summary")
ggplot(df, aes(Bloco, DPPH, fill = gen)) +
geom_bar(stat = "summary", position = position_dodge())
df
ggplot(df, aes(Bloco, DPPH, fill = Genótipo)) +
geom_bar(stat = "summary", position = position_dodge())
ggplot(df, aes(Genótipo, DPPH, fill = Bloco)) +
geom_bar(stat = "summary", position = position_dodge())
ggplot(df, aes(Genótipo, DPPH, fill = factor(Bloco))) +
geom_bar(stat = "summary", position = position_dodge())
ggplot(df, aes(DPPH, Genótipo, fill = factor(Bloco))) +
geom_bar(stat = "summary", position = position_dodge())
anova(aov(DPPH ~ Genótipo * Bloco), data = df)
df
anova(aov(DPPH ~ Genótipo * Bloco, data = df))
anova(aov(DPPH ~ Genótipo + Bloco, data = df))
df
anova(aov(Flavo ~ Genótipo + Bloco, data = df))
anova(aov(Feno ~ Genótipo + Bloco, data = df))
anova(aov(Feno ~ Genótipo + factor(Bloco), data = df))
anova(aov(Flavo ~ Genótipo + factor(Bloco), data = df))
anova(aov(DPPH ~ Genótipo + factor(Bloco), data = df))
anova(aov(DPPH ~ Genótipo + factor(Bloco), data = df |> filter(Bloco != 1)))
anova(aov(DPPH ~ Genótipo + factor(Bloco), data = df |> filter(Bloco != 1)))
df
anova(aov(Flavo ~ Genótipo + factor(Bloco), data = df |> filter(Bloco != 1)))
anova(aov(Feno ~ Genótipo + factor(Bloco), data = df |> filter(Bloco != 1)))
library(tidyverse)
df <-
expand_grid(
trat = paste0("T", 1:3),
rep = paste0("R", 1:5),
planta = paste0("P", 1:1),
)
View(df)
df <-
expand_grid(
trat = paste0("T", 1:3),
rep = paste0("R", 1:5),
planta = paste0("P", 1:2),
)
View(df)
View(df)
df <-
expand_grid(
cultivar = paste0("C", 1:3),
fungo = c("COM", "SEM"),
rep = paste0("R", 1:5),
planta = paste0("P", 1:2),
)
View(df)
library(rio)
export(df, "experimento.xlsx")
get()
getwd()
?boxplot
boxplot(len ~ dose, data = ToothGrowth,
boxwex = 0.25, at = 1:3 - 0.2,
subset = supp == "VC", col = "yellow",
main = "Guinea Pigs' Tooth Growth",
xlab = "Vitamin C dose mg",
ylab = "tooth length",
xlim = c(0.5, 3.5), ylim = c(0, 35), yaxs = "i")
ToothGrowth
library(ggplot2)
ggplot(ToothGrowth, aes(dose, len)) +
geom_boxplot()
ggplot(ToothGrowth, aes(factor(dose), len)) +
geom_boxplot()
library(rio)
library(tidyverse)
library(metan)
library(ggridges)
library(ggthemes)
library(patchwork)
df <- import_list("data/progresso.xlsx")
g2022 <- df$`2022` |> select(GEN, RGPLA) |> rename(A2022 = RGPLA)
g2023 <- df$`2023` |> select(GEN, RGPLA) |> rename(A2023 = RGPLA)
g2024 <- df$`2024` |> select(GEN, RGPLA) |> rename(A2024 = RGPLA)
dfge <-
reduce(list(g2024, g2023, g2022), left_join) |>
remove_rows_na()
df_ggplot <-
dfge |>
pivot_longer(-GEN, names_to = "AMB", values_to = "RGPLA")
